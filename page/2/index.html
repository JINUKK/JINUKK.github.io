<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>KOO|디벨로그</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="What I learned">
<meta property="og:type" content="website">
<meta property="og:title" content="KOO|디벨로그">
<meta property="og:url" content="http://JINUKK.github.io/page/2/index.html">
<meta property="og:site_name" content="KOO|디벨로그">
<meta property="og:description" content="What I learned">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="KOO|디벨로그">
<meta name="twitter:description" content="What I learned">
  
    <link rel="alternate" href="/atom.xml" title="KOO|디벨로그" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">KOO|디벨로그</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Develop &amp; Sabjil Log</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://JINUKK.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-190610-Django-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/10/190610-Django-Study/" class="article-date">
  <time datetime="2019-06-10T06:33:45.000Z" itemprop="datePublished">2019-06-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Study-Review/">Study Review</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/10/190610-Django-Study/">2019.06.10 Django Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li><p>allauth template 파일 수정하기</p>
<ul>
<li>django-allauth를 사용했을때, 이미 만들어진 template 파일을 사용하게 된다.</li>
<li>template 파일을 커스텀하려면 다음과 같이 진행하도록 한다.</li>
</ul>
<ol>
<li><p>회원을 관리하는 앱에서 template 폴더를 생성한다.</p>
<ul>
<li>회원을 관리하는 앱 이름은 account로 하지 않는 것이 좋다.</li>
<li><p>만약 account로 했을 경우, 다음의 경우를 보자.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line">    <span class="string">'django.contrib.humanize'</span>,</span><br><span class="line">    <span class="comment"># account라는 이름으로 앱을 생성한다면</span></span><br><span class="line">    <span class="string">'account'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sites'</span>,</span><br><span class="line">    <span class="string">'allauth'</span>,</span><br><span class="line">    <span class="string">'allauth.account'</span>,</span><br><span class="line">    <span class="string">'allauth.socialaccount'</span>,</span><br><span class="line">    <span class="string">'allauth.socialaccount.providers.naver'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 위에서 보는 것처럼 account라는 이름으로 앱을 생성했을 때,</span></span><br><span class="line"><span class="comment"># allauth.account라는 이름과 충돌이 생겨 문제가 발생할 수 있다.</span></span><br><span class="line"><span class="comment"># 따라서 다른 이름으로 하는 것이 좋다.(ex] accounts)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>template 폴더를 생성할 경우, templates라는 폴더를 만든다.</p>
</li>
<li>그리고 하위에 앱 이름과 같은 폴더를 한번 더 만든 뒤 그 하단에 html 파일을 생성했다.</li>
<li>하지만 이번에는 allauth의 template 파일을 커스텀하는 것이기 때문에 account라고 생성한다.</li>
<li>account라고 생성하지 않는다면 이미 만들어진 template 파일을 수정할 수 없게 된다.</li>
<li>가상 환경 폴더인 venv/lib에는 설치한 패키지들이 들어있다.</li>
<li>패키지 안에 allauth/templates 폴더를 보면 이미 생성된 html 파일들을 볼 수 있다.</li>
<li>생성된 html 파일들과 이름을 같게 하여 html 파일을 account 폴더 하단에 생성한다.</li>
<li>이미 생성된 html 파일의 내용을 그대로 가져와서 내가 바꾸고 싶은 부분만 커스텀하면 된다.</li>
<li><p>로그인과 로그아웃 관련 template 파일을 가져와서 커스텀해보자.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--// 기존에 생성되있는 login.html //--&gt;</span></span><br><span class="line">&#123;% extends "account/base.html" %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% load i18n %&#125;</span><br><span class="line">&#123;% load account socialaccount %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block head_title %&#125;&#123;% trans "Sign In" %&#125;&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;% trans "Sign In" %&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% get_providers as socialaccount_providers %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% if socialaccount_providers %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;% blocktrans with site.name as site_name %&#125;Please sign in with one</span><br><span class="line">of your existing third party accounts. Or, <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; signup_url &#125;&#125;"</span>&gt;</span>sign up<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">for a &#123;&#123; site_name &#125;&#125; account and sign in below:&#123;% endblocktrans %&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"socialaccount_ballot"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"socialaccount_providers"</span>&gt;</span></span><br><span class="line">    &#123;% include "socialaccount/snippets/provider_list.html" with process="login" %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"login-or"</span>&gt;</span>&#123;% trans 'or' %&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% include "socialaccount/snippets/login_extra.html" %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% else %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;% blocktrans %&#125;If you have not created an account yet, then please</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; signup_url &#125;&#125;"</span>&gt;</span>sign up<span class="tag">&lt;/<span class="name">a</span>&gt;</span> first.&#123;% endblocktrans %&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"login"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">action</span>=<span class="string">"&#123;% url 'account_login' %&#125;"</span>&gt;</span></span><br><span class="line">&#123;% csrf_token %&#125;</span><br><span class="line">&#123;&#123; form.as_p &#125;&#125;</span><br><span class="line">&#123;% if redirect_field_value %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"&#123;&#123; redirect_field_name &#125;&#125;"</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; redirect_field_value &#125;&#125;"</span> /&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"button secondaryAction"</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'account_reset_password' %&#125;"</span>&gt;</span>&#123;% trans "Forgot Password?" %&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"primaryAction"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>&#123;% trans "Sign In" %&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>widget_tweaks를 사용하면 만들어진 폼을 별도로 처리하고싶을 때 편하게 처리할 수 있다.</p>
</li>
<li><p>다음과 같이 django-widget-tweaks를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install django-widget-tweaks</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py의 INSTALLED_APPS에 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    <span class="string">'widget_tweaks'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>가져온 login.html에서 원하는 부분만 수정한다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--// 원하는 부분만 커스텀한 login.html 화면 //--&gt;</span></span><br><span class="line">&#123;% extends 'base.html' %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% load i18n %&#125;</span><br><span class="line">&#123;% load account socialaccount %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block head_title %&#125;&#123;% trans "Sign In" %&#125;&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% get_providers as socialaccount_providers %&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert alert-info mt-3"</span> <span class="attr">role</span>=<span class="string">"alert"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"alert-heading"</span>&gt;</span>&#123;% trans "Sign In" %&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &#123;% if socialaccount_providers %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;% blocktrans with site.name as site_name %&#125;Please sign in with one</span><br><span class="line">        of your existing third party accounts. Or, <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123;signup_url&#125;&#125;"</span>&gt;</span>sign up<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        for a &#123;&#123; site_name &#125;&#125; account and sign in below:&#123;% endblocktrans %&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"socialaccount_ballot"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"socialaccount_providers"</span>&gt;</span></span><br><span class="line">            &#123;% include "socialaccount/snippets/provider_list.html" with process="login" %&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &#123;% include "socialaccount/snippets/login_extra.html" %&#125;</span><br><span class="line"></span><br><span class="line">    &#123;% else %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;% blocktrans %&#125;If you have not created an account yet, then please</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; signup_url &#125;&#125;"</span>&gt;</span>sign up<span class="tag">&lt;/<span class="name">a</span>&gt;</span> first.&#123;% endblocktrans %&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">&#123;% load widget_tweaks %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"login"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">action</span>=<span class="string">"&#123;% url 'account_login' %&#125;"</span>&gt;</span></span><br><span class="line">    &#123;% csrf_token %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>&#123;&#123;form.login.label&#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        &#123;% render_field form.login class="form-control" placeholder='Email Or Username' %&#125;</span><br><span class="line">        &#123;% for error in form.login.errors %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span>&#123;&#123; error &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"form-text text-muted"</span>&gt;</span>We'll never share your email with anyone else.<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>&#123;&#123;form.password.label&#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        &#123;% render_field form.password class="form-control" placeholder='User password' %&#125;</span><br><span class="line">        &#123;% for error in form.password.errors %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span>&#123;&#123; error &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &#123;% if redirect_field_value %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"&#123;&#123; redirect_field_name &#125;&#125;"</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; redirect_field_value &#125;&#125;"</span>/&gt;</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-info btn-sm"</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'account_reset_password' %&#125;"</span>&gt;</span>&#123;% trans "Forgot Password?" %&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>&#123;% trans "Sign In" %&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>로그인할 때 추가한 소셜 로그인 목록에 대한 template 파일은 다음과 같다.</p>
<ul>
<li>socialaccount/snippets/provider_list.html</li>
</ul>
</li>
<li><p>위와 같은 폴더 이름으로 폴더와 파일을 생성하고 이미 만들어진 내용을 가져와서 수정해보자.</p>
</li>
</ul>
</li>
</ol>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://JINUKK.github.io/2019/06/10/190610-Django-Study/" data-id="cjyco4krh00ah31wuv2ok06qw" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-190607-Django-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/07/190607-Django-Study/" class="article-date">
  <time datetime="2019-06-07T05:27:00.000Z" itemprop="datePublished">2019-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Study-Review/">Study Review</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/07/190607-Django-Study/">2019.06.07 Django Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="new-blog-Project"><a href="#new-blog-Project" class="headerlink" title="new blog Project"></a>new blog Project</h2><ul>
<li><p>Create, Update, Delete View를 구현한다.</p>
<ol>
<li><p>Views.py에 추가 작성한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostUpdate</span><span class="params">(UpdateView)</span>:</span></span><br><span class="line">    model = Post</span><br><span class="line">    template_name = <span class="string">'post/post_update.html'</span></span><br><span class="line">    fields = [<span class="string">'title'</span>,<span class="string">'text'</span>,<span class="string">'tag'</span>]</span><br><span class="line">    <span class="comment"># success_url =&gt; get_abslute_url</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> reverse_lazy</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostDelete</span><span class="params">(DeleteView)</span>:</span></span><br><span class="line">    model = Post</span><br><span class="line">    template_name = <span class="string">'post/post_delete.html'</span></span><br><span class="line">    success_url = reverse_lazy(<span class="string">'post:post_list'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.utils.text <span class="keyword">import</span> slugify</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostCreate</span><span class="params">(CreateView)</span>:</span></span><br><span class="line">    model = Post</span><br><span class="line">    template_name = <span class="string">'post/post_create.html'</span></span><br><span class="line">    fields = [<span class="string">'title'</span>, <span class="string">'text'</span>, <span class="string">'tag'</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">form_valid</span><span class="params">(self, form)</span>:</span></span><br><span class="line">        <span class="comment"># 작성자 매칭 - form.instance.author_id = self.request.user.id</span></span><br><span class="line">        <span class="comment"># 관리자 페이지에서만 title 값이 slug가 된다.</span></span><br><span class="line">        <span class="comment"># slugify를 사용해서 title의 값을 slug 값으로 한다.</span></span><br><span class="line">        form.instance.slug = slugify(form.instance.title, allow_unicode=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> super().form_valid(form)</span><br><span class="line"></span><br><span class="line"><span class="comment"># tag 기능 구현</span></span><br><span class="line"><span class="keyword">from</span> tagging.views <span class="keyword">import</span> TaggedObjectList</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostTaggedObjectList</span><span class="params">(TaggedObjectList)</span>:</span></span><br><span class="line">    model = Post</span><br><span class="line">    allow_empty = <span class="literal">True</span></span><br><span class="line">    template_name = <span class="string">'post/post_list.html'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.views.generic <span class="keyword">import</span> TemplateView</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TagList</span><span class="params">(TemplateView)</span>:</span></span><br><span class="line">    template_name = <span class="string">'post/tag_list.html'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>urls.py에 경로를 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">app_name = <span class="string">'post'</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'tags/'</span>, TagList.as_view(), name=<span class="string">'tag_list'</span>),</span><br><span class="line">    path(<span class="string">'tags/&lt;tag&gt;/'</span>, PostTaggedObjectList.as_view(), name=<span class="string">'post_taggedlist'</span>),</span><br><span class="line">    path(<span class="string">'create/'</span>, PostCreate.as_view(), name=<span class="string">'post_create'</span>),</span><br><span class="line">    path(<span class="string">'delete/&lt;int:pk&gt;/'</span>, PostDelete.as_view(), name=<span class="string">'post_delete'</span>),</span><br><span class="line">    path(<span class="string">'update/&lt;int:pk&gt;/'</span>, PostUpdate.as_view(), name=<span class="string">'post_update'</span>),</span><br><span class="line">    path(<span class="string">'detail/&lt;slug&gt;/'</span>, PostDetail.as_view(), name=<span class="string">'post_detail'</span>),</span><br><span class="line">    path(<span class="string">'&lt;category_slug&gt;/'</span>, PostList.as_view(), name=<span class="string">'post_list_with_category'</span>),</span><br><span class="line">    path(<span class="string">''</span>, PostList.as_view(), name=<span class="string">'post_list'</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>template 파일을 생성하고 작성한다.</p>
<ul>
<li><ul>
<li>post/templates/post/post_create.html<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends 'base.html' %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block title %&#125;</span><br><span class="line">Create - &#123;&#123;object.title|truncatechars:15&#125;&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row mt-3"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span></span><br><span class="line">        &#123;% include 'post/category_list.html' %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">            &#123;% csrf_token %&#125;</span><br><span class="line">            &#123;&#123;form.media&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-striped"</span>&gt;</span></span><br><span class="line">            &#123;&#123;form.as_table&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">value</span>=<span class="string">"Write"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>layout/base.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--// create 관련 기능 추가 //--&gt;</span></span><br><span class="line"> &#123;% if user.is_authenticated %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"nav-link"</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'post:post_create' %&#125;"</span>&gt;</span>Write<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<ul>
<li><p>post/templates/post/post_update.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends 'base.html' %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block title %&#125;</span><br><span class="line">Update - &#123;&#123;object.title|truncatechars:15&#125;&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row mt-3"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span></span><br><span class="line">        &#123;% include 'post/category_list.html' %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">            &#123;% csrf_token %&#125;</span><br><span class="line">            &#123;&#123;form.media&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-striped"</span>&gt;</span></span><br><span class="line">            &#123;&#123;form.as_table&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">value</span>=<span class="string">"Update"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>post/templates/post/post_delete.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends 'base.html' %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block title %&#125;</span><br><span class="line">Delete - &#123;&#123;object.title|truncatechars:15&#125;&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row mt-3"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span></span><br><span class="line">        &#123;% include 'post/category_list.html' %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">            &#123;% csrf_token %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span> <span class="attr">value</span>=<span class="string">"Delete"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>post/templates/post/post_detail.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends 'base.html' %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block title %&#125;</span><br><span class="line">&#123;&#123;object.title|truncatechars:15&#125;&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row mt-3"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span></span><br><span class="line">        &#123;% include 'post/category_list.html' %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span> <span class="attr">style</span>=<span class="string">"padding-bottom:3px; border-bottom:2px dashed #000000;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"color:red;"</span>&gt;</span>[&#123;&#123;object.category&#125;&#125;]<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"font-weight:bold;"</span>&gt;</span>&#123;&#123;object.title&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm text-muted"</span> <span class="attr">style</span>=<span class="string">"text-align:right; font-size:0.9em;"</span>&gt;</span>&#123;&#123;object.formatcreated2&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        &#123;&#123;object.text|safe&#125;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--// 태그 기능 추가 //--&gt;</span></span><br><span class="line">        &#123;% load tagging_tags %&#125;</span><br><span class="line"></span><br><span class="line">        &#123;% tags_for_object object as tags %&#125;</span><br><span class="line">        &#123;% if tags %&#125;</span><br><span class="line">            Tags :</span><br><span class="line">            &#123;% for tag in tags %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'post:post_taggedlist' tag.name %&#125;"</span>&gt;</span>#&#123;&#123;tag.name&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            &#123;% endfor %&#125;</span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--// 수정, 삭제 기능 추가 //--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span> <span class="attr">style</span>=<span class="string">"padding-bottom:3px; border-bottom:2px dashed #000000;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm"</span> <span class="attr">style</span>=<span class="string">"text-align:right;"</span>&gt;</span></span><br><span class="line">                &#123;% if user.is_authenticated %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'post:post_update' object.id %&#125;"</span>&gt;</span>[수정]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'post:post_delete' object.id %&#125;"</span> <span class="attr">style</span>=<span class="string">"color:red"</span>&gt;</span>[삭제]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                &#123;% endif %&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>post/templates/post/tag_list.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--//</span></span><br><span class="line"><span class="comment">tag list 출력</span></span><br><span class="line"><span class="comment">자주 나오는 tag일수록 글자 사이즈가 크게 출력된다.</span></span><br><span class="line"><span class="comment">//--&gt;</span></span><br><span class="line">&#123;% extends 'base.html' %&#125;</span><br><span class="line">&#123;% block title %&#125;Tag List&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">&#123;% load tagging_tags %&#125;</span><br><span class="line">&#123;% tag_cloud_for_model post.Post as post_tags with steps=9 min_count=1 distribution=log %&#125;</span><br><span class="line">    &#123;% for tag in post_tags %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'post:post_taggedlist' tag.name %&#125;"</span> <span class="attr">style</span>=<span class="string">"font-size:&#123;&#123;tag.font_size&#125;&#125;em;"</span>&gt;</span>&#123;&#123;tag&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Comment 앱을 생성해서 Comment 기능을 추가한다.</p>
<ol>
<li><p>comment 앱을 생성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py startapp comment</span><br><span class="line"></span><br><span class="line"><span class="comment"># 잊지말고 settings.py의 INSTALLED_APPS에 추가하자.</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>models.py를 작성한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth <span class="keyword">import</span> get_user_model</span><br><span class="line"><span class="keyword">from</span> django.contrib.contenttypes.fields <span class="keyword">import</span> GenericForeignKey</span><br><span class="line"><span class="keyword">from</span> django.contrib.contenttypes.models <span class="keyword">import</span> ContentType</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Comment</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    1. 작성자</span></span><br><span class="line"><span class="string">    2. 어떤 모델과의 관계가 있는지</span></span><br><span class="line"><span class="string">    3. + 작성자가 없다면, 모델과의 관계가 없다면</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    author = models.ForeignKey(get_user_model(), on_delete=models.CASCADE, related_name=<span class="string">'my_comments'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ContentType 사용</span></span><br><span class="line">    content_type = models.ForeignKey(ContentType, on_delete=models.CASCADE)</span><br><span class="line">    object_id = models.PositiveIntegerField()</span><br><span class="line">    content_object = GenericForeignKey(<span class="string">'content_type'</span>, <span class="string">'object_id'</span>)</span><br><span class="line"></span><br><span class="line">    text = models.CharField(max_length=<span class="number">400</span>)</span><br><span class="line">    created = models.DateTimeField(auto_now_add=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">formatcreated</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.created.strftime(<span class="string">'%Y.%m.%d. %H:%M'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># migrate를 잊지 말자.</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>admin.py를 작성한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"></span><br><span class="line"><span class="comment"># Register your models here.</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Comment</span><br><span class="line"></span><br><span class="line">admin.site.register(Comment)</span><br></pre></td></tr></table></figure>
</li>
<li><p>views.py를 작성한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .forms <span class="keyword">import</span> CommentForm</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> redirect</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> resolve</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Comment</span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> messages</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_comment</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> request.user.is_anonymous:</span><br><span class="line">        comment_form = CommentForm(request.POST)</span><br><span class="line">        comment_form.instance.author_id = request.user.id</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> comment_form.is_valid():</span><br><span class="line">            comment_form.save()</span><br><span class="line">            messages.add_message(request, messages.SUCCESS, <span class="string">"댓글을 작성하였습니다."</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            messages.add_message(request, messages.WARNING, <span class="string">"Comment Invalid"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        messages.add_message(request, messages.WARNING, <span class="string">"댓글은 로그인 사용자만 남길 수 있습니다."</span>)</span><br><span class="line"></span><br><span class="line">    referer = request.META[<span class="string">'HTTP_REFERER'</span>]</span><br><span class="line">    <span class="keyword">return</span> redirect(referer)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete_comment</span><span class="params">(request, pk)</span>:</span></span><br><span class="line">    comment = Comment.objects.filter(pk=pk)</span><br><span class="line">    <span class="keyword">if</span> comment.exists() <span class="keyword">and</span> comment[<span class="number">0</span>].author == request.user:</span><br><span class="line">        comment.delete()</span><br><span class="line">        messages.add_message(request, messages.SUCCESS, <span class="string">"댓글을 삭제하였습니다."</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        messages.add_message(request, messages.WARNING, <span class="string">"댓글을 삭제할 수 없습니다."</span>)</span><br><span class="line"></span><br><span class="line">    referer = request.META[<span class="string">'HTTP_REFERER'</span>]</span><br><span class="line">    <span class="keyword">return</span> redirect(referer)</span><br></pre></td></tr></table></figure>
</li>
<li><p>urls.py를 작성한다.</p>
</li>
</ol>
<ul>
<li><p>config/urls.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    path(<span class="string">'comment/'</span>, include(<span class="string">'comment.urls'</span>)),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>comment/urls.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'delete_comment/&lt;int:pk&gt;'</span>, delete_comment, name=<span class="string">'delete_comment'</span>),</span><br><span class="line">    path(<span class="string">'add_comment/'</span>, add_comment, name=<span class="string">'add_comment'</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="6">
<li>template 파일을 생성하고 작성한다.</li>
</ol>
<ul>
<li><p>comment/templates/comment/show_comment.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"&#123;% url 'add_comment' %&#125;"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    &#123;% csrf_token %&#125;</span><br><span class="line">    &#123;&#123;form.as_p&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-outline-dark btn-sm"</span> <span class="attr">value</span>=<span class="string">"등록"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">"3"</span> <span class="attr">class</span>=<span class="string">"align-left"</span> <span class="attr">style</span>=<span class="string">"color:red"</span>&gt;</span>댓글 &#123;&#123;object_list.count&#125;&#125;<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    &#123;% for object in object_list %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"font-weight:bold;"</span>&gt;</span>&#123;&#123;object.author.username&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"font-size:0.8em;"</span> <span class="attr">class</span>=<span class="string">"text-muted"</span>&gt;</span>&#123;&#123;object.formatcreated&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            &#123;% if object.author == user %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'delete_comment' object.id %&#125;"</span> <span class="attr">style</span>=<span class="string">"color:red"</span>&gt;</span><span class="tag">&lt;<span class="name">small</span>&gt;</span>[삭제]<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">br</span>&gt;</span>    </span><br><span class="line">            &#123;&#123;object.text&#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>layout/base.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--// 댓글과 관련한 메세지 기능 추가 //--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span></span><br><span class="line">        &#123;% if messages %&#125;</span><br><span class="line">        &#123;% for message in messages %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert alert-&#123;&#123;message.tags&#125;&#125;"</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">        &#123;% endif%&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="7">
<li>templatetags 파일을 생성하고 작성한다.</li>
</ol>
<ul>
<li><p>comment/templatetags/comment.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.template.loader <span class="keyword">import</span> render_to_string</span><br><span class="line"><span class="keyword">from</span> django.contrib.contenttypes.models <span class="keyword">import</span> ContentType</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.template <span class="keyword">import</span> Library</span><br><span class="line">register = Library()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> comment.forms <span class="keyword">import</span> CommentForm</span><br><span class="line"><span class="keyword">from</span> comment.models <span class="keyword">import</span> Comment</span><br><span class="line"></span><br><span class="line"><span class="meta">@register.simple_tag(takes_context=True)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_comment</span><span class="params">(context, content_type, object_id)</span>:</span></span><br><span class="line">    <span class="comment"># 폼 만들기</span></span><br><span class="line">    content_type = ContentType.objects.get_for_model(content_type)</span><br><span class="line">    form = CommentForm(initial=&#123;<span class="string">'content_type'</span>:content_type, <span class="string">'object_id'</span>:object_id&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 해당 하는 댓글 목록 뽑기</span></span><br><span class="line">    comments = Comment.objects.filter(content_type=content_type, object_id=object_id).all()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 템플릿 렌더링</span></span><br><span class="line">    <span class="keyword">return</span> render_to_string(<span class="string">'comment/show_comment.html'</span>,&#123;<span class="string">'form'</span>:form, <span class="string">'object_list'</span>:comments&#125;, request=context[<span class="string">'request'</span>])</span><br></pre></td></tr></table></figure>
</li>
<li><p>post/templates/post/detail.html에 comment 기능을 추가한다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load comment %&#125;</span><br><span class="line">&#123;% show_comment content_type=object object_id=object.id %&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://JINUKK.github.io/2019/06/07/190607-Django-Study/" data-id="cjyco4krj00aj31wuoagmngc8" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-190604-Django-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/04/190604-Django-Study/" class="article-date">
  <time datetime="2019-06-04T07:21:21.000Z" itemprop="datePublished">2019-06-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Study-Review/">Study Review</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/04/190604-Django-Study/">2019.06.04 Django Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="new-blog-Project"><a href="#new-blog-Project" class="headerlink" title="new blog Project"></a>new blog Project</h2><ul>
<li><p>새로운 블로그 웹 사이트를 만들어본다.</p>
<ol>
<li><p>프로젝트를 생성하고 django를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install django</span><br></pre></td></tr></table></figure>
</li>
<li><p>django project를 만든다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ django-admin startproject config .</span><br></pre></td></tr></table></figure>
</li>
<li><p>다음 항목을 설치하고 해당 관련 항목들의 코드를 추가하도록 한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># debug tool bar 설치</span></span><br><span class="line">$ pip install django-debug-toolbar</span><br><span class="line"></span><br><span class="line"><span class="comment"># 모델 간의 관계도를 그리기 위해 extentions 설치</span></span><br><span class="line">$ pip install django-extensions</span><br><span class="line"></span><br><span class="line"><span class="comment"># HTML 편집기를 사용하기 위해 ckeditor 설치</span></span><br><span class="line">$ pip install django-ckeditor</span><br><span class="line"></span><br><span class="line"><span class="comment"># tag 기능을 사용하기 위해 tagging 설치</span></span><br><span class="line">$ pip install django-tagging</span><br><span class="line"></span><br><span class="line"><span class="comment"># static 파일을 서빙하기 위해 whitenoise 설치</span></span><br><span class="line">$ pip install whitenoise</span><br><span class="line"></span><br><span class="line"><span class="comment"># 의존성 리스트 생성</span></span><br><span class="line">$ pip freeze &gt; requirements.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>post라는 이름을 가진 앱을 만든다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp post</span><br></pre></td></tr></table></figure>
</li>
<li><p>models.py를 작성한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># post/models.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> ckeditor_uploader.fields <span class="keyword">import</span> RichTextUploadingField</span><br><span class="line"><span class="keyword">from</span> tagging.fields <span class="keyword">import</span> TagField</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> resolve_url</span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Category</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">100</span>)</span><br><span class="line">    slug = models.SlugField(max_length=<span class="number">120</span>, unique=<span class="literal">True</span>, allow_unicode=<span class="literal">True</span>, db_index=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># 상위 카테고리를 만들기 위해</span></span><br><span class="line">    parent_category = models.ForeignKey(<span class="string">"self"</span>, on_delete=models.SET_NULL, blank=<span class="literal">True</span>, null=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_absolute_url</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> resolve_url(<span class="string">'post:post_list_with_category'</span>, self.slug)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    category = models.ForeignKey(Category, on_delete=models.SET_NULL, blank=<span class="literal">True</span>, null=<span class="literal">True</span>)</span><br><span class="line">    title = models.CharField(max_length=<span class="number">100</span>)</span><br><span class="line">    slug = models.SlugField(max_length=<span class="number">120</span>, unique=<span class="literal">True</span>, allow_unicode=<span class="literal">True</span>, db_index=<span class="literal">True</span>)</span><br><span class="line">    text = RichTextUploadingField()</span><br><span class="line">    material = models.FileField(upload_to=<span class="string">'material/%Y/%m/%d'</span>,blank=<span class="literal">True</span>)</span><br><span class="line">    tag = TagField(blank=<span class="literal">True</span>)</span><br><span class="line">    created = models.DateTimeField(auto_now_add=<span class="literal">True</span>)</span><br><span class="line">    updated = models.DateTimeField(auto_now=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.title + <span class="string">" at "</span> + self.created.strftime(<span class="string">"%Y-%m-%d"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_absolute_url</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> resolve_url(<span class="string">'post:post_detail'</span>, self.slug)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 날짜.월.일만 나오는 포맷을 사용하고 싶어서 추가</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">formatcreated</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.created.strftime(<span class="string">'%Y.%m.%d'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">formatupdated</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.updated.strftime(<span class="string">'%Y.%m.%d'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 모델 설계가 끝났다면 반드시 makemigrations와 migrate를 진행한다.</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>admin.py를 작성한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># post/admin.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CategoryAdmin</span><span class="params">(admin.ModelAdmin)</span>:</span></span><br><span class="line">    list_display = [<span class="string">'id'</span>,<span class="string">'name'</span>,<span class="string">'slug'</span>]</span><br><span class="line">    prepopulated_fields = &#123;<span class="string">'slug'</span>:(<span class="string">'name'</span>,)&#125;</span><br><span class="line">admin.site.register(Category, CategoryAdmin)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostAdmin</span><span class="params">(admin.ModelAdmin)</span>:</span></span><br><span class="line">    list_display = [<span class="string">'id'</span>,<span class="string">'title'</span>,<span class="string">'slug'</span>,<span class="string">'created'</span>,<span class="string">'updated'</span>]</span><br><span class="line">    ordering = [<span class="string">'-updated'</span>,<span class="string">'-created'</span>]</span><br><span class="line">    prepopulated_fields = &#123;<span class="string">'slug'</span>: (<span class="string">'title'</span>,)&#125;</span><br><span class="line">admin.site.register(Post, PostAdmin)</span><br></pre></td></tr></table></figure>
</li>
<li><p>views.py를 작성한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># post/views.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">from</span> django.views.generic.list <span class="keyword">import</span> ListView</span><br><span class="line"><span class="keyword">from</span> django.views.generic.edit <span class="keyword">import</span> CreateView, UpdateView, DeleteView</span><br><span class="line"><span class="keyword">from</span> django.views.generic.detail <span class="keyword">import</span> DetailView</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostList</span><span class="params">(ListView)</span>:</span></span><br><span class="line">    model = Post</span><br><span class="line">    <span class="comment"># paginate 테스트를 위해 1로 설정</span></span><br><span class="line">    paginate_by = <span class="number">1</span></span><br><span class="line">    template_name = <span class="string">'post/post_list.html'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 해당 category에 속한 리스트만을 불러오기 위해</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span><span class="params">(self)</span>:</span></span><br><span class="line">        queryset = super().get_queryset()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'category_slug'</span> <span class="keyword">in</span> self.kwargs:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                category = Category.objects.get(slug=self.kwargs[<span class="string">'category_slug'</span>])</span><br><span class="line">                queryset = queryset.filter(category=category)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> queryset</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostDetail</span><span class="params">(DetailView)</span>:</span></span><br><span class="line">    model = Post</span><br><span class="line">    template_name = <span class="string">'post/post_detail.html'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>context_processors.py를 생성하고 작성한 후, settings.py도 수정한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># context 항목을 만드는 데 있어서 중복 작업이 있을 경우,</span></span><br><span class="line"><span class="comment"># context_processors를 만들어서 사용하면 중복 작업을 제거할 수 있다.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># post/contest_processors.py</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Category</span><br><span class="line"></span><br><span class="line"><span class="comment"># 상위 카테고리만 구별하기 위해</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">category</span><span class="params">(request)</span>:</span></span><br><span class="line">    categories = Category.objects.filter(parent_category=<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">'categories'</span>: categories&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># config/settings.py</span></span><br><span class="line">TEMPLATES = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">#...</span></span><br><span class="line">        <span class="string">'OPTIONS'</span>: &#123;</span><br><span class="line">            <span class="string">'context_processors'</span>: [</span><br><span class="line">                <span class="string">'django.template.context_processors.debug'</span>,</span><br><span class="line">                <span class="string">'django.template.context_processors.request'</span>,</span><br><span class="line">                <span class="string">'django.contrib.auth.context_processors.auth'</span>,</span><br><span class="line">                <span class="string">'django.contrib.messages.context_processors.messages'</span>,</span><br><span class="line">                <span class="comment"># 추가</span></span><br><span class="line">                <span class="string">'post.context_processors.category'</span>,</span><br><span class="line">            ],</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>urls.py를 작성한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># config/urls.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.views.static <span class="keyword">import</span> serve</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path,re_path, include</span><br><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">'ckeditor/'</span>, include(<span class="string">'ckeditor_uploader.urls'</span>)),</span><br><span class="line">    re_path(<span class="string">r'^media/(?P&lt;path&gt;.*)$'</span>, serve, &#123;<span class="string">'document_root'</span>:settings.MEDIA_ROOT&#125;),</span><br><span class="line">    <span class="comment"># post.urls 추가</span></span><br><span class="line">    path(<span class="string">''</span>, include(<span class="string">'post.urls'</span>))</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> settings.DEBUG:</span><br><span class="line">    <span class="keyword">import</span> debug_toolbar</span><br><span class="line">    urlpatterns = [</span><br><span class="line">        path(<span class="string">'__debug__/'</span>, include(debug_toolbar.urls)),</span><br><span class="line">    ] + urlpatterns</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># post/urls.py</span></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">app_name = <span class="string">'post'</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'detail/&lt;slug&gt;/'</span>, PostDetail.as_view(), name=<span class="string">'post_detail'</span>),</span><br><span class="line">    path(<span class="string">'&lt;category_slug&gt;/'</span>, PostList.as_view(), name=<span class="string">'post_list_with_category'</span>),</span><br><span class="line">    path(<span class="string">''</span>, PostList.as_view(), name=<span class="string">'post_list'</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>template 파일을 생성하고 작성한다.</p>
</li>
</ol>
<ul>
<li><p>layout/base.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123;% block title %&#125;Blog&#123;% endblock %&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">integrity</span>=<span class="string">"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"</span> <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"navbar navbar-expand-lg navbar-light bg-light sticky-top"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>Blog<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"navbar-toggler"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">data-toggle</span>=<span class="string">"collapse"</span> <span class="attr">data-target</span>=<span class="string">"#navbarSupportedContent"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">aria-controls</span>=<span class="string">"navbarSupportedContent"</span> <span class="attr">aria-expanded</span>=<span class="string">"false"</span> <span class="attr">aria-label</span>=<span class="string">"Toggle navigation"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"navbar-toggler-icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"collapse navbar-collapse"</span> <span class="attr">id</span>=<span class="string">"navbarSupportedContent"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"navbar-nav mr-auto"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item active"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"nav-link"</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"nav-link"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Blog<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"nav-link"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Guest Book<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-inline my-2 my-lg-0"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control mr-sm-2"</span> <span class="attr">type</span>=<span class="string">"search"</span> <span class="attr">placeholder</span>=<span class="string">"Search"</span> <span class="attr">aria-label</span>=<span class="string">"Search"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-outline-success my-2 my-sm-0"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>Search<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">    &#123;% block content %&#125;</span><br><span class="line"></span><br><span class="line">    &#123;% endblock %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.3.1.slim.min.js"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">integrity</span>=<span class="string">"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">integrity</span>=<span class="string">"sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">integrity</span>=<span class="string">"sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>post/templates/post/post_list.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends 'base.html' %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row mt-3"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col col-md-2"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- category --&gt;</span></span><br><span class="line">        &#123;% include 'post/category_list.html' %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-10 col-md-8"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- list --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-striped"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>title<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>created<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>updated<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                &#123;% if user.is_authenticated %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>update<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>delete<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                &#123;% endif %&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">            &#123;% for object in object_list %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;object.id&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123;object.get_absolute_url&#125;&#125;"</span>&gt;</span>&#123;&#123;object.title&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;object.formatcreated&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;object.formatupdated&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                &#123;% if user.is_authenticated %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'post:post_update' object.id %&#125;"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'post:post_delete' object.id %&#125;"</span>&gt;</span>delete<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                &#123;% endif %&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            &#123;% endfor %&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        &#123;% if is_paginated %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">nav</span> <span class="attr">aria-label</span>=<span class="string">"Page navigation"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"pagination justify-content-center"</span>&gt;</span></span><br><span class="line">                &#123;% if page_obj.has_previous %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"page-item"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"page-link"</span> <span class="attr">href</span>=<span class="string">"?page=&#123;&#123;page_obj.previous_page_number&#125;&#125;"</span>&gt;</span>Previous<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                &#123;% else %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"page-item disabled"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"page-link"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Previous<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                &#123;% endif %&#125;</span><br><span class="line">                &#123;% for page in paginator.page_range %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"page-item"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"page-link"</span> <span class="attr">href</span>=<span class="string">"?page=&#123;&#123;page&#125;&#125;"</span>&gt;</span>&#123;&#123;page&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                &#123;% endfor %&#125;</span><br><span class="line">                &#123;% if page_obj.has_next %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"page-item"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"page-link"</span> <span class="attr">href</span>=<span class="string">"?page=&#123;&#123;page_obj.next_page_number&#125;&#125;"</span>&gt;</span>Next<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                &#123;% else %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"page-item disabled"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"page-link"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Next<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                &#123;% endif %&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>post/templates/post/category_list.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"accordion"</span> <span class="attr">id</span>=<span class="string">"category_list"</span>&gt;</span></span><br><span class="line">    &#123;% for category in categories %&#125;</span><br><span class="line">        &#123;% include 'post/part_category_list.html' %&#125;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>post/templates/post/part_category_list.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> &#123;% <span class="attr">if</span> <span class="attr">parent_id</span> %&#125; <span class="attr">class</span>=<span class="string">"collapse card category_sub_&#123;&#123;parent_id&#125;&#125;"</span> &#123;% <span class="attr">else</span> %&#125; <span class="attr">class</span>=<span class="string">"card"</span> &#123;% <span class="attr">endif</span> %&#125;&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-header"</span> <span class="attr">style</span>=<span class="string">"padding:0;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"mb-0"</span>&gt;</span></span><br><span class="line">            &#123;% if parent_id %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-link"</span> <span class="attr">href</span>=<span class="string">"&#123;&#123;category.get_absolute_url&#125;&#125;"</span>&gt;</span></span><br><span class="line">                &#123;&#123;category&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            &#123;% else %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-link"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">data-toggle</span>=<span class="string">"collapse"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">data-target</span>=<span class="string">".category_sub_&#123;&#123;category.id&#125;&#125;"</span> <span class="attr">aria-expanded</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">                &#123;&#123;category&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- related_name을 쓰지 않았기 때문에 [default_name]_set으로 불러온다. --&gt;</span></span><br><span class="line">&#123;% if category.category_set %&#125;</span><br><span class="line"><span class="comment">&lt;!-- category.id를 parent_id로 사용 --&gt;</span></span><br><span class="line">&#123;% with category.id as parent_id %&#125;</span><br><span class="line">&#123;% for category in category.category_set.all %&#125;</span><br><span class="line">&#123;% include 'post/part_category_list.html' %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line">&#123;% endwith %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>post/templates/post/post_detail.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends 'base.html' %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block title %&#125;</span><br><span class="line"><span class="comment">&lt;!-- 커스텀 템플릿 태그 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- truncatechars : 문자열을 지정 글자 개수까지 제한 --&gt;</span></span><br><span class="line">&#123;&#123;object.title|truncatechars:15&#125;&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row mt-3"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span></span><br><span class="line">        &#123;% include 'post/category_list.html' %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-8"</span>&gt;</span></span><br><span class="line">        &#123;&#123;object.text|safe&#125;&#125;</span><br><span class="line"></span><br><span class="line">        Tags :</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>커스텀 템플릿 태그 만들기</p>
<ul>
<li>커스텀 탬플릿 태그를 만들렸면 templatetags 폴더를 만들어야 한다.</li>
<li>templatetags에 작성한 파일 이름으로 템플릿 파일에서 불러올 수 있다.</li>
<li><p>템플릿 라이브러리 변수를 만든다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># templatetags/exam.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> template</span><br><span class="line"></span><br><span class="line">register = template.Library()</span><br></pre></td></tr></table></figure>
</li>
<li><p>필터를 등록할 때는 다음과 같이 사용한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># templatetags/exam.py</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@ register.filter</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_two</span><span class="params">(value)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> value + <span class="number">2</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>등록한 필터는 다음과 같이 사용한다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load exam %&#125;</span><br><span class="line">&#123;&#123;변수|add_two&#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>추가 인자가 있는 필터는 다음과 같이 사용한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># templatetags/exam.py</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@register.filter</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">string_append</span><span class="params">(left, right)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> left+<span class="string">"-"</span>+right</span><br></pre></td></tr></table></figure>
</li>
<li><p>등록한 필터는 다음과 같이 사용한다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load exam %&#125;</span><br><span class="line">&#123;&#123;'string1'|string_append:'string2'&#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>태그를 등록할 때는 다음과 같이 사용한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@register.simple_tag</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_template</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render_to_string(<span class="string">'exam/test.html'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>등록한 태그는 다음과 같이 사용한다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load exam %&#125;</span><br><span class="line">&#123;% print_template %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 태그 결과를 변수로 지정할 경우 --&gt;</span></span><br><span class="line">&#123;% load exam %&#125;</span><br><span class="line">&#123;% print_template as test %&#125;</span><br><span class="line">&#123;&#123;test&#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://JINUKK.github.io/2019/06/04/190604-Django-Study/" data-id="cjyco4krl00an31wu112fy3ip" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-190603-Django-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/03/190603-Django-Study/" class="article-date">
  <time datetime="2019-06-03T07:21:17.000Z" itemprop="datePublished">2019-06-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Study-Review/">Study Review</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/03/190603-Django-Study/">2019.06.03 Django Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="blog-Project"><a href="#blog-Project" class="headerlink" title="blog Project"></a>blog Project</h2><ul>
<li><p>멀티데이터베이스 만들기</p>
<ul>
<li>데이터베이스도 스케일링을 고려해야 함</li>
<li>마스터 + 슬레이브(읽기 전용)의 형태</li>
</ul>
<ol>
<li><p>마스터로 사용할 데이터베이스를 생성한다.</p>
<ul>
<li>Amazon AWS에서 데이터베이스/RDS를 누른다.</li>
<li>데이터베이스 생성을 누른다.</li>
<li>PostgreSQL 선택 및 화면 하단의 RDS 프리티어에 적용되는 옵션만 사용에 체크한다.</li>
<li>DB 엔진 버전은 PostgreSQL 10.6-R1 선택한다.<ul>
<li>PostgreSQL 9.3.5 이상부터 일기 전용 복제본을 사용할 수 있다.</li>
</ul>
</li>
<li>용량은 20Gib로 설정하고 관리자 정보를 입력한다.</li>
<li>퍼블릭 엑세스 가능성은 ‘예’를 선택한다.<ul>
<li>실습 환경에서는 [예]를 선택하고, 프로덕션 환경에서는 꼭 [아니오]로 변경한다.</li>
</ul>
</li>
<li>데이터베이스 이름을 입력하고 백업 보존 기간은 1일로 설정한다.<ul>
<li>읽기 전용 복제본을 만들려면 백업 기능이 활성화되어 있어야 한다.</li>
</ul>
</li>
<li>성능 개선 도우미는 비활성화하고 데이터베이스 생성을 누른다.</li>
<li><p>인스턴스 생성이 완료되면 settings.py의 DATABESES 부분을 수정한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># pip install psycopg2-binary를 설치하자.</span></span><br><span class="line"></span><br><span class="line">DATABASES = &#123;</span><br><span class="line">     <span class="string">'default'</span>: &#123;</span><br><span class="line">         <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.postgresql_psycopg2'</span>,</span><br><span class="line">         <span class="string">'NAME'</span>: <span class="string">'데이터베이스 이름'</span>,</span><br><span class="line">         <span class="string">'USER'</span>:<span class="string">'마스터 사용자 이름'</span>,</span><br><span class="line">         <span class="string">'PASSWORD'</span>:<span class="string">'마스터 사용자 비밀번호'</span>,</span><br><span class="line">         <span class="string">'HOST'</span>:<span class="string">'아마존 RDS의 엔드포인트'</span>,</span><br><span class="line">         <span class="string">'POST'</span>:<span class="string">'데이터베이스 접속 포트번호'</span>,</span><br><span class="line">     &#125;,</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>수정이 완료되면 migrate한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py migrate</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>슬레이브(읽기 전용)로 사용할 데이터베이스를 생성한다.</p>
<ul>
<li>마스터로 사용할 데이터베이스를 누른 후, 상단 메뉴의 작업에서 읽기 복제본 생성을 누른다.</li>
<li>생성 창이 나타나면 퍼블릭 엑세스 가능 부분에서 예를 누른다.</li>
<li>데이터베이스 식별자를 입력한다.</li>
<li>읽기 전용 복제본 생성을 누른다.</li>
<li><p>위와 같은 방법으로 하나를 더 생성한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- 퍼블릭 엑세스 가능과 데이터베이스 식별자를 잘 설정한다.</span><br><span class="line">- 복제본을 생성하는 것이기 때문에 옵션을 모두 건드릴 필요가 없다.</span><br><span class="line">- 읽기 데이터베이스인 경우, 높은 사양을 원한다면 인스턴스 사양을 올릴 수 있다.</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py의 DATABESES 정보를 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">'default'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.postgresql_psycopg2'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">'multi'</span>,</span><br><span class="line">        <span class="string">'USER'</span>:<span class="string">'마스터 사용자 이름'</span>,</span><br><span class="line">        <span class="string">'PASSWORD'</span>:<span class="string">'마스터 사용자 비밀번호'</span>,</span><br><span class="line">        <span class="string">'HOST'</span>:<span class="string">'마스터 전용 데이터베이스의 엔드포인트'</span>,</span><br><span class="line">        <span class="string">'POST'</span>:<span class="string">'5432'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment"># 복제했기 때문에 다른 것은 모두 같으나, HOST만 달라지게 된다.</span></span><br><span class="line">    <span class="comment"># 엔드 포인트 주소를 잘 확인하자.</span></span><br><span class="line">    <span class="comment"># 식별자가 다를 뿐 데이터베이스의 이름은 모두 같다.</span></span><br><span class="line">    <span class="string">'read1'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.postgresql_psycopg2'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">'multi'</span>,</span><br><span class="line">        <span class="string">'USER'</span>:<span class="string">'마스터 사용자 이름'</span>,</span><br><span class="line">        <span class="string">'PASSWORD'</span>:<span class="string">'마스터 사용자 비밀번호'</span>,</span><br><span class="line">        <span class="string">'HOST'</span>:<span class="string">'첫 번째 읽기 전용 데이터베이스의 엔드포인트'</span>,</span><br><span class="line">        <span class="string">'POST'</span>:<span class="string">'5432'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'read2'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.postgresql_psycopg2'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">'multi'</span>,</span><br><span class="line">        <span class="string">'USER'</span>:<span class="string">'마스터 사용자 이름'</span>,</span><br><span class="line">        <span class="string">'PASSWORD'</span>:<span class="string">'마스터 사용자 비밀번호'</span>,</span><br><span class="line">        <span class="string">'HOST'</span>:<span class="string">'두 번째 읽기 전용 데이터베이스의 엔드포인트'</span>,</span><br><span class="line">        <span class="string">'POST'</span>:<span class="string">'5432'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>라우터 클래스를 만들어서 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># config/master_slave_router.py</span></span><br><span class="line"><span class="comment"># 자동으로 쓰기, 읽기 데이터베이스를 분기해서 사용하는 것이 아니기 때문이다.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MasterSlaveRouter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">db_for_read</span><span class="params">(self, model, **hints)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> random.choice([<span class="string">'read1'</span>, <span class="string">'read2'</span>])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">db_for_write</span><span class="params">(self, model, **hints)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'default'</span> <span class="comment"># return None으로 대체 가능</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">allow_relation</span><span class="params">(self, obj1, obj2, **hints)</span>:</span></span><br><span class="line">        db_list = (<span class="string">'default'</span>, <span class="string">'read1'</span>, <span class="string">'read2'</span>)</span><br><span class="line">        <span class="keyword">if</span> obj1._state.db <span class="keyword">in</span> db_list <span class="keyword">and</span> obj2.state_db <span class="keyword">in</span> db_list:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># return None의 의미</span></span><br><span class="line">        <span class="comment"># 다음 라우터에게 물어보겠다</span></span><br><span class="line">        <span class="comment"># 전부 default에 넣겠다</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">allow_migrate</span><span class="params">(self, db, app_label, model_name=None, **hints)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py에 만든 라우터를 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DATABASE_ROUTERS = [<span class="string">'config.master_slave_router.MasterSlaveRouter'</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>debug toolbar를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># debug toolbar</span></span><br><span class="line">$ pip install django-debug-toolbar</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># settings.py</span></span><br><span class="line"><span class="comment"># INSTALLED_APPS에 항목 추가</span></span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    <span class="string">'debug_toolbar'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># MIDDLEWARE에 항목 추가</span></span><br><span class="line">MIDDLEWARE = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    <span class="string">'debug_toolbar.middleware.DebugToolbarMiddleware'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># debug = True, internal_ips</span></span><br><span class="line">INTERNAL_IPS = [<span class="string">'127.0.0.1'</span>]</span><br><span class="line"></span><br><span class="line">DEBUG_TOOLBAR_PANELS = [</span><br><span class="line">    <span class="string">'debug_toolbar.panels.versions.VersionsPanel'</span>,</span><br><span class="line">    <span class="string">'debug_toolbar.panels.timer.TimerPanel'</span>,</span><br><span class="line">    <span class="string">'debug_toolbar.panels.settings.SettingsPanel'</span>,</span><br><span class="line">    <span class="string">'debug_toolbar.panels.headers.HeadersPanel'</span>,</span><br><span class="line">    <span class="string">'debug_toolbar.panels.request.RequestPanel'</span>,</span><br><span class="line">    <span class="string">'debug_toolbar.panels.sql.SQLPanel'</span>,</span><br><span class="line">    <span class="string">'debug_toolbar.panels.staticfiles.StaticFilesPanel'</span>,</span><br><span class="line">    <span class="string">'debug_toolbar.panels.templates.TemplatesPanel'</span>,</span><br><span class="line">    <span class="string">'debug_toolbar.panels.cache.CachePanel'</span>,</span><br><span class="line">    <span class="string">'debug_toolbar.panels.signals.SignalsPanel'</span>,</span><br><span class="line">    <span class="string">'debug_toolbar.panels.logging.LoggingPanel'</span>,</span><br><span class="line">    <span class="string">'debug_toolbar.panels.redirects.RedirectsPanel'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># config.urls.py</span></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include</span><br><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> settings.DEBUG:</span><br><span class="line">    <span class="keyword">import</span> debug_toolbar</span><br><span class="line">    urlpatterns = [</span><br><span class="line">        path(<span class="string">'debug/'</span>, include(debug_toolbar.urls)),</span><br><span class="line">    ] + urlpatterns</span><br></pre></td></tr></table></figure>
</li>
<li><p>관리자 페이지로 접속하여 debug toolbar를 이용하여 데이터베이스를 확인한다.</p>
</li>
<li>유저 정보를 공유하기 위해 다른 프로젝트를 생성한다.<ul>
<li>Amazon AWS에서 RDS를 새로 생성하여 migrate까지 진행한다.</li>
</ul>
</li>
<li><p>멀티데이터베이스를 진행한 프로젝트에서 settings.py의 DATABASES 정보를 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"> DATABASES = &#123;</span><br><span class="line">    <span class="string">'default'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.postgresql_psycopg2'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">'multi'</span>,</span><br><span class="line">        <span class="string">'USER'</span>:<span class="string">'마스터 사용자 이름'</span>,</span><br><span class="line">        <span class="string">'PASSWORD'</span>:<span class="string">'마스터 사용자 비밀번호'</span>,</span><br><span class="line">        <span class="string">'HOST'</span>:<span class="string">'마스터 전용 데이터베이스의 엔드포인트'</span>,</span><br><span class="line">        <span class="string">'POST'</span>:<span class="string">'5432'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'read1'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.postgresql_psycopg2'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">'multi'</span>,</span><br><span class="line">        <span class="string">'USER'</span>:<span class="string">'마스터 사용자 이름'</span>,</span><br><span class="line">        <span class="string">'PASSWORD'</span>:<span class="string">'마스터 사용자 비밀번호'</span>,</span><br><span class="line">        <span class="string">'HOST'</span>:<span class="string">'첫 번째 읽기 전용 데이터베이스의 엔드포인트'</span>,</span><br><span class="line">        <span class="string">'POST'</span>:<span class="string">'5432'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'read2'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.postgresql_psycopg2'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">'multi'</span>,</span><br><span class="line">        <span class="string">'USER'</span>:<span class="string">'마스터 사용자 이름'</span>,</span><br><span class="line">        <span class="string">'PASSWORD'</span>:<span class="string">'마스터 사용자 비밀번호'</span>,</span><br><span class="line">        <span class="string">'HOST'</span>:<span class="string">'두 번째 읽기 전용 데이터베이스의 엔드포인트'</span>,</span><br><span class="line">        <span class="string">'POST'</span>:<span class="string">'5432'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment"># 유저의 정보를 공유하기 위해 다른 프로젝트를 생성</span></span><br><span class="line">    <span class="comment"># 다른 프로젝트에서 생성한 데이터베이스의 정보</span></span><br><span class="line">    <span class="string">'user'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.postgresql_psycopg2'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">'base_user'</span>,</span><br><span class="line">        <span class="string">'USER'</span>:<span class="string">'마스터 사용자 이름'</span>,</span><br><span class="line">        <span class="string">'PASSWORD'</span>:<span class="string">'마스터 사용자 비밀번호'</span>,</span><br><span class="line">        <span class="string">'HOST'</span>: <span class="string">'추가로 생성한 데이터베이스의 엔드포인트'</span>,</span><br><span class="line">        <span class="string">'PORT'</span>: <span class="string">'5432'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>유저의 정보 데이터베이스를 위한 라우터를 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># config/user_router.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserRouter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">db_for_read</span><span class="params">(self, model, **hints)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> model._meta.model_name == <span class="string">'user'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'user'</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">db_for_write</span><span class="params">(self, model, **hints)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> model._meta.model_name == <span class="string">'user'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'user'</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">allow_relation</span><span class="params">(self, obj1, obj2, **hints)</span>:</span></span><br><span class="line">        db_list = settings.DATABASES.keys() <span class="comment"># settings에서 불러다가 사용할 수도 있다.</span></span><br><span class="line">        <span class="keyword">if</span> obj1._state.db <span class="keyword">in</span> db_list <span class="keyword">and</span> obj2._state.db <span class="keyword">in</span> db_list:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">allow_migrate</span><span class="params">(self, db, app_label, model_name=None, **hints)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py에 라우터를 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DATABASE_ROUTERS = [<span class="string">'config.user_router.UserRouter'</span>,</span><br><span class="line">            <span class="string">'config.master_slave_router.MasterSlaveRouter'</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>관리자 페이지로 접속하여 멀티데이터베이스 프로젝트에서 로그인해본다.</p>
<ul>
<li>유저 정보를 위한 프로젝트 관리자의 아이디로 접속이 된다.</li>
<li>멀티데이터베이스 프로젝트에서 유저를 생성해본다.</li>
<li>유저 정보 프로젝트에서 관리자 접속 후, 유저 정보를 확인해본다.</li>
<li>두 프로젝트의 유저 정보가 공유되는 것을 확인할 수 있다.</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li><p>EC2에 장고 배포하기(정리)</p>
<ol>
<li>인스턴스를 생성한다.<ul>
<li>Amazon AWS에서 컴퓨팅/EC2로 이동한다.</li>
<li>인스턴스 시작을 누른다.</li>
<li>Ubuntu server 18.04를 선택한다.</li>
<li>인스턴스 타입은 t2.micro를 선택한다.<ul>
<li>서비스 상황에 따라 더 높은 사양을 선택하는 것도 생각하도록 하자.</li>
</ul>
</li>
<li>인스턴스 세부 구성에서는 설정하지 않고 넘어간다.</li>
<li>스토리지 크기는 20Gib로, 볼륨 유형은 범용 SSD를 선택하고 넘어간다.</li>
<li>태그 추가에서는 설정하지 않고 넘어간다.</li>
<li>보안 그룹 구성에서는 새 보안 그룹을 선택하고 이름과 설명을 입력한다.<ul>
<li>ELB에 넣을 인스턴스를 생성하는 경우엔 기존 인스턴스와 같은 그룹을 선택하도록 한다,</li>
</ul>
</li>
<li>검토 및 시작에서는 정보를 검토하고 시작하기를 누른다.</li>
<li>인스턴스에 접속하기 위해 새 키 파일 생성을 누른다.</li>
<li>키 페어 이름을 입력 후, 다운로드를 누르고 인스턴스를 시작한다.</li>
<li>인스턴스 보기를 누르고 목록을 확인 후, 생성한 인스턴스의 이름을 설정해둔다.</li>
</ul>
</li>
<li><p>터미널에서 명령어를 입력한다.</p>
<ul>
<li><p>다운로드 받은 키 페어 파일의 권한을 400으로 변경한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 키 페어 파일 경로도 가능</span></span><br><span class="line">$ chmod 400 [키 페어 파일 이름]</span><br></pre></td></tr></table></figure>
</li>
<li><p>키 페어 파일을 .ssh 폴더로 이동시킨다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mv [키 페어 파일 이름] ~/.ssh/</span><br></pre></td></tr></table></figure>
</li>
<li><p>키 페어 파일을 이용하여 EC2 인스턴스에 ssh 접속을 한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -i [키 페어 파일 경로] [계정]@[EC2 접속 주소]</span><br></pre></td></tr></table></figure>
</li>
<li><p>서버에 접속 후, 기존 패키지를 업데이트한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br></pre></td></tr></table></figure>
</li>
<li><p>Nginx를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install nginx</span><br></pre></td></tr></table></figure>
</li>
<li><p>vim을 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install vim</span><br></pre></td></tr></table></figure>
</li>
<li><p>파이썬 관련 패키지를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install python3-dev python3-venv python3-piip</span><br></pre></td></tr></table></figure>
</li>
<li><p>django 앱 구동용 계정을 생성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo useradd -b /home -m -s /bin/bash django</span><br></pre></td></tr></table></figure>
</li>
<li><p>www-data 그룹에 django 유저를 추가한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo usermod -a -G www-data django</span><br></pre></td></tr></table></figure>
</li>
<li><p>www-data 그룹에 ubuntu 유저를 추가한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># FTP로 업로드 시, ubuntu 계정을 사용하므로, 앱 소스 코드 폴더에 쓰기 권한을 얻기 위함</span></span><br><span class="line">$ sudo usermod -a -G Www-data ubuntu</span><br></pre></td></tr></table></figure>
</li>
<li><p>소스 코드를 업로드하기 위한 폴더를 만든다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -p는 중간 폴더가 없다면 자동 생성하게 해준다.</span></span><br><span class="line">$ sudo mkdir -p /var/www/django</span><br></pre></td></tr></table></figure>
</li>
<li><p>uswgi 모듈을 위해 폴더를 만든다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mkdir /var/www/django/run</span><br><span class="line">$ sudo mkdir /var/www/django/logs</span><br><span class="line">$ sudo mkdir /var/www/django/ini</span><br></pre></td></tr></table></figure>
</li>
<li><p>uwsgi 설정 파일을 만든다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /var/www/django/ini/uwsgi.ini</span><br><span class="line"></span><br><span class="line"><span class="comment"># uwsgi.ini 내용</span></span><br><span class="line">[uwsgi]</span><br><span class="line">uid = django</span><br><span class="line">base = /var/www/django</span><br><span class="line"></span><br><span class="line">home = %(base)/venv</span><br><span class="line"><span class="built_in">chdir</span> = %(base)</span><br><span class="line">module = config.wsgi:application</span><br><span class="line">env = DJANGO_SETTINGS_MODULE=config.settings</span><br><span class="line"></span><br><span class="line">master = <span class="literal">true</span></span><br><span class="line">processes = 5</span><br><span class="line"></span><br><span class="line">socket = %(base)/run/uwsgi.sock</span><br><span class="line">logto = %(base)/logs/uwsgi.log</span><br><span class="line">chown-socket = %(uid):www-data</span><br><span class="line">chmod-socket = 660</span><br><span class="line">vacuum = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>가상 환경을 소스 코드 폴더 밑에 만든다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo python3 -m venv /var/www/django/venv</span><br></pre></td></tr></table></figure>
</li>
<li><p>소스 코드를 업로드하기 전에 폴더의 소유자와 사용 권한을 변경한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo chown -R django:www-data /var/www/django</span><br><span class="line">$ sudo chmod -R g+w /var/www/django</span><br></pre></td></tr></table></figure>
</li>
<li><p>파일질라를 실행하여 왼쪽 상단 탭에서 사이트 관리자로 들어간다.</p>
</li>
<li><p>새로운 사이트를 추가하고 접속 정보를 설정한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- 프로토콜 : SFTP</span><br><span class="line">- 호스트 : EC2의 접속 주소</span><br><span class="line">- 로그온 유형 : 키 파일</span><br><span class="line">- 사용자 : ubuntu</span><br><span class="line">- 키 파일 : 키 페어 파일 경로 지정</span><br></pre></td></tr></table></figure>
</li>
<li><p>고급 탭에서 기본 로컬 디렉터리와 기본 리모트 디렉터리를 지정한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">기본 로컬 디렉터리 = pycharm으로 만든 프로젝트 폴더</span><br><span class="line">기본 리모트 디렉터리 = 소스 코드를 업로드할 폴더</span><br></pre></td></tr></table></figure>
</li>
<li><p>설정이 완료되었다면 연결을 누른다.</p>
</li>
<li>처음 접속 시, 알 수 없는 호스트 창이 나타나면 캐시에 등록을 체크하고 확인을 누른다.</li>
<li>접속이 성공했다면, 소스 코드를 업로드한다.</li>
<li><p>가상 환경에 패키지를 설치하기 위해 소스 코드 폴더로 이동한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /var/www/django</span><br></pre></td></tr></table></figure>
</li>
<li><p>관리자 모드로 변경하고 가상 환경을 활성화시킨다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -s</span><br><span class="line">$ <span class="built_in">source</span> venv/bin/activate</span><br></pre></td></tr></table></figure>
</li>
<li><p>의존성 리스트를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install -r requirements.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>uwsgi를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install uwsgi</span><br></pre></td></tr></table></figure>
</li>
<li><p>runserver 명령어를 통해 django project의 구동 여부를 확인한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py runserver 0:8000</span><br></pre></td></tr></table></figure>
</li>
<li><p>구동이 된다면 runserver를 종료하고, uwsgi 모듈로 구동 여부를 확인한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ uwsgi --http :8000 --home /var/www/django/venv/ --<span class="built_in">chdir</span> /var/www/django/ --module config.wsgi</span><br></pre></td></tr></table></figure>
</li>
<li><p>웹 브라우저를 통해 접속하여 구동이 된다면 uwsgi.service 파일을 작성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/systemed/system/uwsgi.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># uwsgi.service 내용</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=uWSGI Emperor service</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStart=/var/www/django/venv/bin/uwsgi --emperor /var/www/django/ini</span><br><span class="line">User=django</span><br><span class="line">Group=www-data</span><br><span class="line">Restart=on-failure</span><br><span class="line">KillSignal=SIGQUIT</span><br><span class="line">Type=notify</span><br><span class="line">NotifyAccess=all</span><br><span class="line">StandardError=syslog</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>
</li>
<li><p>uwsgi의 서비스를 시작하고 시작 서비스로 등록한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl start uwsgi</span><br><span class="line">$ sudo systemctl <span class="built_in">enable</span> uwsgi</span><br></pre></td></tr></table></figure>
</li>
<li><p>서비스 상태를 확인한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># active 상태인지 확인하자.</span></span><br><span class="line">$ sudo systemctl status uwsgi</span><br></pre></td></tr></table></figure>
</li>
<li><p>Nginx의 default 파일을 수정한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/nginx/sites-available/default</span><br><span class="line"></span><br><span class="line"><span class="comment"># default 내용</span></span><br><span class="line">upstream django &#123;</span><br><span class="line">    server unix:/var/www/django/run/uwsgi.sock;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    charset utf-8;</span><br><span class="line">    access_log /var/www/django/logs/access.log;</span><br><span class="line">    error_log /var/www/django/logs/error.log;</span><br><span class="line">    server_name _;</span><br><span class="line"></span><br><span class="line">    location = /favicon.ico &#123; access_log off; log_not_found off; &#125;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">            include         /etc/nginx/uwsgi_params;</span><br><span class="line">            uwsgi_pass      django;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Nginx를 재시작한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl restart nginx</span><br></pre></td></tr></table></figure>
</li>
<li><p>웹 브라우저에 퍼블릭 DNS를 입력하고 구동 여부를 확인한다.</p>
</li>
<li><p>소스 코드의 업데이트를 위해서 아래 명령어를 실행해두자.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo chmod -R g+w /var/www/django</span><br></pre></td></tr></table></figure>
</li>
<li><p>django와 관련된 부분이 수정이 된다면 uwsgi 서비스를 재시작해야 한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl restart uwsgi</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
</li>
<li><p>로드밸런서 설정하기</p>
<ul>
<li>EC2 왼쪽 메뉴에서 로드 밸런서를 누른다.</li>
<li>로드밸런서 생성을 누르고 Application Load Balancer의 생성을 누른다.</li>
<li>다음으로, 로드밸런스의 이름을 입력하고 리스너를 만들어준다.<ul>
<li>HTTPS의 443을 추가한다.</li>
</ul>
</li>
<li>가용 영역에서는 모두 체크하고 보안 설정 구성으로 넘어간다.</li>
<li>보안 설정 구성에서는 다음과 같이 설정한다.<ul>
<li>인증서 유형은 ACM에서 인증서 선택을 누른다.</li>
<li>인증서 이름에는 기존에 생성한 인증서가 나타난다.</li>
<li>보안 정책은 ELBSecurityPolicy-2016-08을 선택한다.<ul>
<li>보안 정책이 너무 최신일 경우, 폭넓게 지원하지 않는 문제가 있다.</li>
</ul>
</li>
<li>보안 그룹 구성에서는 새 보안 그룹 생성을 누르고 이름과 설명을 입력한다.</li>
<li>라우팅 구성에서는 그룹의 이름을 입력하고 대상 등록으로 넘어간다.<ul>
<li>프로토콜은 https(443)이 아닌 http(80)가 맞으므로 바꾸지 않아도 된다.</li>
</ul>
</li>
<li>대상 등록에서는 미리 생성해둔 인스턴스를 추가하고 검토로 넘어간다.</li>
<li>검토 화면에서 내용을 확인하고 생성을 누른다.</li>
<li>생성이 완료되면 닫기를 누른다.</li>
<li>생성된 로드밸런서의 DNS 이름으로 웹 브라우저에 접속해보자.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- https로만  접속하게 하고 싶을 경우</span><br><span class="line">1. 해당 로드밸런서에서 리스너에 http(80)을 편집으로 들어간다.</span><br><span class="line">2. 기본 작업에 다음으로 전달하는 값을 제거한다.</span><br><span class="line">3. 다음으로 리디렉션을 누르고 포트 번호를 443으로 설정한다.</span><br><span class="line">4. 체크를 누르고 업데이트를 누른다.</span><br><span class="line">5. 이제 https로만 접속되는지 확인한다.</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Route53을 통해 로드밸런서 등록하기</p>
<ul>
<li>네트워킹 및 콘텐츠 전송/Route53으로 이동한다.</li>
<li>호스팅 영역에 등록한 도메인을 누르고 레코드 세트 생성을 누른다.</li>
<li>원하는 이름을 입력하고 별칭에서 예를 선택한다.</li>
<li>등록한 로드밸런서를 선택하고 생성한다.</li>
<li>웹 브라우저에서 https를 붙인 도메인 주소로 접속해본다.</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://JINUKK.github.io/2019/06/03/190603-Django-Study/" data-id="cjyco4krn00ar31wu7jgjvo1h" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-190531-Django-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/31/190531-Django-Study/" class="article-date">
  <time datetime="2019-05-31T07:21:12.000Z" itemprop="datePublished">2019-05-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Study-Review/">Study Review</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/31/190531-Django-Study/">2019.05.31 Django Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="blog-Project"><a href="#blog-Project" class="headerlink" title="blog Project"></a>blog Project</h2><ul>
<li><p>ACM으로 SSL 인증서 발급받기</p>
<ul>
<li>https 기능을 사이트에 적용하기 위해 ssl 인증서를 등록해야 한다.</li>
<li>로드밸런서를 사용하면 쉽게 인증서를 적용할 수 있다.</li>
<li>Amazon에서는 ACM Service를 통해 무료로 인증서를 발급하고 있다.</li>
</ul>
<ol>
<li><p>서비스 탭에서 보안, 자격 증명 및 규정 준수/Certificate Manager를 누른다.</p>
</li>
<li><p>인증서 목록이 나타나면 인증서 요청을 누른다.</p>
</li>
<li><p>인증서 요청에서는 공인 인증서 요청을 선택한다.</p>
</li>
<li><p>도메인 이름 추가에서는 도메인 이름을 입력한다.</p>
<ul>
<li>*로 발급받으면 모든 서브 도메인에 적용이 가능하다.(와일드 카드 도메인)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ex) *.jinukk.me</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>검증 방법에서는 DNS 검증을 누르고 검토로 넘어간다.</p>
</li>
<li><p>내용을 확인하고 확인 및 요청을 누른다.</p>
</li>
<li><p>검증 단계에서는 검증 보류 메세지를 볼 수 있는데 도메인 주소 왼쪽 화살표를 누른다.</p>
</li>
<li><p>상세 정보에서 Route53에서 레코드 생성을 누른다.</p>
</li>
<li><p>레코드 내용을 확인하고 생성을 누른다.</p>
</li>
<li><p>생성 성공 메시지를 확인하면 계속을 누른다.</p>
</li>
<li><p>인증서 목록으로 돌아오면 검증 미완료 상태를 볼 수 있다.</p>
</li>
<li><p>일정 시간이 지나면 검증 완료가 되고 인증서가 발급된 것을 확인할 수 있다.</p>
</li>
</ol>
</li>
<li><p>ELB Setting 하기</p>
<ul>
<li>ELB는 Amazon AWS의 Load Balancer Service</li>
<li>클래식, 네트워크, 애플리케이션 로드밸런서로 구성</li>
<li>복수의 서버에 적절한 트래픽을 분산시키기 위해 사용</li>
</ul>
<ol>
<li><p>서비스 탭에서 컴퓨팅/EC2를 누른다.</p>
</li>
<li><p>EC2 왼쪽 메뉴에서 로드 밸런싱/로드밸런서를 누른다.</p>
</li>
<li><p>로드 밸런서 생성을 누른다.</p>
</li>
<li><p>유형은 Application Load Balancer의 생성을 누른다.</p>
</li>
<li><p>로드 밸런서 구성에서는 다음과 같이 설정한다.</p>
<ul>
<li>이름을 입력한다.</li>
<li>리스너를 설정해준다.</li>
<li>가용 영역에서는 필요한 AZ를 체크한다.</li>
</ul>
</li>
<li><p>보안 설정 구성에서는 HTTPS 관련 경고창이 나타나지만 넘어가도록 한다.</p>
</li>
<li><p>보안 그룹 구성에서는 이름과 설명을 입력하고 인바운드 규칙을 설정한다.</p>
</li>
<li><p>라우팅 구성에서는 그룹의 이름을 입력하고 넘어가도록 한다.</p>
</li>
<li><p>대상 등록에서는 미리 생성한 EC2 인스턴스를 선택하고 등록된 항목에 추가를 누른다.</p>
</li>
<li><p>검토 화면에서는 내용을 확인하고 생성을 누른다.</p>
</li>
<li><p>자동으로 생성이 진행되며, 절차가 끝나 완료가 나타나면 닫기를 누른다.</p>
</li>
</ol>
<ul>
<li>로드밸런서 목록에서 생성된 로드밸런서를 확인한다.<ul>
<li>생성된 로드밸런서를 누르고 하단에 DNS 이름으로 접속해보자.</li>
</ul>
</li>
</ul>
</li>
<li><p>로드밸런서에 ssl 인증서 적용하기</p>
<ol>
<li><p>인증서를 적용할 로드밸런서를 선택하고 리스너 탭에 잇는 리스너 추가를 누른다.</p>
</li>
<li><p>HTTPS(443)을 설정하고 기본 작업은 다음으로 전달을 선택한 뒤, 리스너 그룹을 선택한다.</p>
</li>
<li><p>보안 정책은 ELBSecurityPolicy-2016-08을 선택한다.</p>
</li>
<li><p>기본 ssl 인증서는 ACM에서 발급받은 인증서를 선택하고 저장을 누른다.</p>
</li>
<li><p>성공적으로 생성함 메세지를 확인한다.</p>
</li>
<li><p>네트워킹 및 콘텐츠 전송/Route53으로 이동한다.</p>
</li>
<li><p>호스팅 영역에 등록한 도메인을 누르고 레코드 세트 생성을 누른다.</p>
</li>
<li><p>원하는 이름을 입력하고 별칭에서 예를 선택한다.</p>
</li>
<li><p>등록한 로드밸런서를 선택하고 생성한다.</p>
</li>
<li><p>웹 브라우저에서 https를 붙인 도메인 주소로 접속해본다.</p>
</li>
</ol>
</li>
<li><p>EC2 인스턴스의 이미지를 생성하여 ELB 그룹에 추가하기</p>
<ol>
<li><p>해당 인스턴스의 오른쪽 클릭을 통해 이미지 생성을 누른다.</p>
</li>
<li><p>이미지 이름과 설명을 입력하고, 인스턴스 볼륨을 설정한다.</p>
<ul>
<li>이름과 설명에는 생성한 날짜를 함께 적는 것이 좋다.</li>
<li>인스턴스 볼륨의 크기는 20Gib로, 유형은  범용 SSD를 선택하였다.</li>
</ul>
</li>
<li><p>EC2 왼쪽 메뉴에서 이미지/AMI를 누른다.</p>
</li>
<li><p>이미지 생성이 완료되면 시작하기를 누른다.</p>
</li>
<li><p>인스턴스 유형에서는 실습이므로 t2.micro로 선택한다.(목적에 따라 성능을 개선할 수 있다.)</p>
</li>
<li><p>인스턴스 세부 정보 구성에서는 추가할 인스턴스 개수와 서브넷을 선택해준다.</p>
</li>
<li><p>스토리지 추가에서는 크기를 20Gib로, 유형은 범용 SSD를 선택한다.</p>
</li>
<li><p>태그 추가는 넘어가도록 한다.(필요에 따라 설정 가능)</p>
</li>
<li><p>보안 그룹 구성에서는 기존 보안 그룹을 선택하여 이미 생성한 인스턴스와 같은 보안 그룹을 선택한다.</p>
</li>
<li><p>검토 및 시작을 누르고 시작하기를 누른다.</p>
</li>
<li><p>EC2의 인스턴스 목록으로 돌아와서 추가한 인스턴스의 이름을 설정해둔다.</p>
</li>
<li><p>EC2 왼쪽 메뉴에서 로드밸런싱/대상 그룹에서 로드밸런서를 선택하고 하단에 대상 편집을 누른다.</p>
</li>
<li><p>추가한 인스턴스를 등록된 항목에 추가한다.</p>
</li>
<li><p>추가한 인스턴스의 주소로 접속해서 동작하는지 확인한다.</p>
</li>
</ol>
</li>
<li><p>소스 코드가 업데이트 됬다면…</p>
</li>
</ul>
<ol>
<li><p>로드 밸런서 목록에서 본체였던 대상을 제거해준다.</p>
</li>
<li><p>filezilla를 사용하여 소스코드를 업로드한다.</p>
</li>
<li><p>해당 인스턴스의 이미지를 다시 생성한다.(이름에는 날짜와 몇번쨰인지 명명)</p>
</li>
<li><p>AMI 목록에서 추가로 인스턴스들을 생성한다.(서브넷 : a그룹, c그룹)</p>
</li>
<li><p>대상 목록으로 가서 추가한 인스턴스들을 편집을 이용하여 등록한다.</p>
</li>
<li><p>구서버 인스턴스들을 목록에서 제거한다.</p>
</li>
<li><p>동작이 확인된다면, 인스턴스 목록에서 구서버를 종료시킨다.</p>
</li>
<li><p>신규 서버의 이름을 수정한다.</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://JINUKK.github.io/2019/05/31/190531-Django-Study/" data-id="cjyco4krf00ad31wun67jzhf0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-190530-Django-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/30/190530-Django-Study/" class="article-date">
  <time datetime="2019-05-30T07:21:07.000Z" itemprop="datePublished">2019-05-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Study-Review/">Study Review</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/30/190530-Django-Study/">2019.05.30 Django Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="blog-Project"><a href="#blog-Project" class="headerlink" title="blog Project"></a>blog Project</h2><ul>
<li><p>클래스형 뷰와 함수형 뷰</p>
<ul>
<li>클래스형 뷰(Class Based View)<ul>
<li>자주 처리하는 내용을 미리 구현해 놓은 뷰</li>
<li>제대로 사용하려면 내부 속성 값들을 알고 있어야 함</li>
<li>클래스형 뷰를 사용하여 뷰를 구현해도 최종 실행에서는 함수형 뷰로 변환되어 동작</li>
<li>as_view() 메서드를 통해 클래스형 뷰를 함수형 뷰로 변환</li>
</ul>
</li>
<li><p>함수형 뷰(Function Based View)</p>
<ul>
<li>함수형 뷰는 request를 기본 매개변수로 가짐</li>
<li><p>URL에 포함된 패턴그룹을 추가 변수로 가짐</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># urls.py</span></span><br><span class="line">path(<span class="string">'update/&lt;int:pk&gt;/'</span>, create_view)</span><br><span class="line"></span><br><span class="line"><span class="comment"># views.py</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_view</span><span class="params">(request, pk)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>클래스형 뷰는 자주 처리하는 일들을 묶어둔 반면, 함수형 뷰는 모든 일을 직접 처리해야 함</p>
</li>
</ul>
</li>
<li><p>클래스형 뷰와 함수형 뷰 비교</p>
<ul>
<li><p>View</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> JsonResponse</span><br><span class="line"><span class="keyword">from</span> django.views.generic <span class="keyword">import</span> View</span><br><span class="line"></span><br><span class="line"><span class="comment"># 제네릭 뷰를 사용해서 클래스형 뷰를 만들 때는 상속</span></span><br><span class="line"><span class="comment"># 함수형 뷰처럼 모든 내용을 직접 구현하고 싶을 때는 View를 상속받는다 ex) API View</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> render(self.request, <span class="string">'blog/test.html'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">indexView</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">"GET"</span>:</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">'blog/test.html'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JsonView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> JsonResponse(&#123;<span class="string">"data"</span>: <span class="string">'test'</span>&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> JsonResponse(&#123;<span class="string">"data"</span>: <span class="string">'test'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jsonView</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">"GET"</span>:</span><br><span class="line">        <span class="keyword">return</span> JsonResponse(&#123;<span class="string">"data"</span>: <span class="string">'test'</span>&#125;)</span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">"POST"</span>:</span><br><span class="line">        <span class="keyword">return</span> JsonResponse(&#123;<span class="string">"data"</span>: <span class="string">'test'</span>&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>CRUDL(Create, Detail, Update, Delete, List View)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.views.generic.detail <span class="keyword">import</span> DetailView</span><br><span class="line"><span class="keyword">from</span> django.views.generic.list <span class="keyword">import</span> ListView</span><br><span class="line"><span class="keyword">from</span> django.views.generic.edit <span class="keyword">import</span> CreateView, UpdateView, DeleteView</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Post</span><br><span class="line"><span class="keyword">from</span> django.core.paginator <span class="keyword">import</span> Paginator</span><br><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Q</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> Http404</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> redirect</span><br><span class="line"><span class="keyword">from</span> django.forms <span class="keyword">import</span> modelform_factory</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> get_object_or_404</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> reverse_lazy</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> reverse</span><br><span class="line"></span><br><span class="line"><span class="comment"># ListView CBV</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostList</span><span class="params">(ListView)</span>:</span></span><br><span class="line">    model = Post</span><br><span class="line">    <span class="comment"># default : app_name/model_list.html</span></span><br><span class="line">    template_name = <span class="string">'blog/post_list.html'</span></span><br><span class="line">    <span class="comment"># 페이징 기능 활성화</span></span><br><span class="line">    paginate_by = <span class="number">1</span>  <span class="comment"># 한 페이지당 요소 갯수</span></span><br><span class="line">    page_kwarg = <span class="string">'p'</span></span><br><span class="line"></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    setup()</span></span><br><span class="line"><span class="string">    dispatch()</span></span><br><span class="line"><span class="string">    get_queryset()</span></span><br><span class="line"><span class="string">    get_context_data()</span></span><br><span class="line"><span class="string">    render_to_response()</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line"> <span class="comment"># ListView FBV</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">postList</span><span class="params">(request, page)</span>:</span></span><br><span class="line">    <span class="comment"># 페이지 번호 얻기</span></span><br><span class="line">    page = page <span class="keyword">if</span> page <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">    page = int(page)</span><br><span class="line"></span><br><span class="line">    queryset = Post.objects.all()  <span class="comment"># CBV : get_queryset</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># post으로 전달된 데이터 중에서 search 변수값 찾기</span></span><br><span class="line">    search_keyword = request.POST.get(<span class="string">'search'</span>, request.GET.get(<span class="string">'search'</span>, <span class="literal">None</span>))</span><br><span class="line">    context_data = &#123;&#125;</span><br><span class="line">    <span class="keyword">if</span> search_keyword:</span><br><span class="line">        q = Q(text__icontains=search_keyword)</span><br><span class="line">        q |= Q(title__icontains=search_keyword)</span><br><span class="line">        queryset = queryset.filter(q)</span><br><span class="line">        context_data.update(&#123;<span class="string">'search_keyword'</span>: search_keyword&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 페이징 처리</span></span><br><span class="line">    paginator = Paginator(queryset, <span class="number">1</span>)</span><br><span class="line">    page = paginator.page(page)</span><br><span class="line">    context_data.update(&#123;<span class="string">'object_list'</span>: page.object_list,</span><br><span class="line">                        <span class="string">'paginator'</span>: paginator, <span class="string">'page_obj'</span>: page, <span class="string">'is_paginated'</span>: <span class="literal">True</span>&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'blog/post_list.html'</span>, context_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># DetailView CBV</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostDetail</span><span class="params">(DetailView)</span>:</span></span><br><span class="line">    model = Post</span><br><span class="line">    template_name = <span class="string">'blog/post_detail.html'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># pk의 이름을 post_id로 바꾸기</span></span><br><span class="line">    pk_url_kwarg = <span class="string">'post_id'</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    setup()</span></span><br><span class="line"><span class="string">    dispatch()</span></span><br><span class="line"><span class="string">    get()</span></span><br><span class="line"><span class="string">    get_object() - get_queryset()</span></span><br><span class="line"><span class="string">    get_context_data()</span></span><br><span class="line"><span class="string">    render_to_response()</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># DetailView FBV</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">postDetail</span><span class="params">(request, pk)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        object = Post.objects.get(pk=pk)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">raise</span> Http404(<span class="string">"Post does not exists"</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'blog/post_detail.html'</span>, &#123;<span class="string">'object'</span>: object&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># CreateView CBV</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostCreate</span><span class="params">(CreateView)</span>:</span></span><br><span class="line">    model = Post</span><br><span class="line">    fields = [<span class="string">'category'</span>, <span class="string">'title'</span>, <span class="string">'text'</span>]</span><br><span class="line">    <span class="comment"># appname/model_form.html</span></span><br><span class="line">    template_name = <span class="string">'blog/post_create.html'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># success_url이 있는 Create, Update, Delete의 경우</span></span><br><span class="line">    <span class="comment"># 클래스의 속성값을 사용해서 URL을 만들 수 있다.</span></span><br><span class="line">    <span class="comment"># success_url = 'pattern/&#123;변수명&#125;/'</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">form_valid</span><span class="params">(self, form)</span>:</span></span><br><span class="line">        form.instance.author_id = self.request.user.id</span><br><span class="line">        <span class="keyword">return</span> super().form_valid(form)</span><br><span class="line"></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    setup()</span></span><br><span class="line"><span class="string">    dispatch()</span></span><br><span class="line"><span class="string">    get()</span></span><br><span class="line"><span class="string">    post() - 저장처리</span></span><br><span class="line"><span class="string">    get_context_data()</span></span><br><span class="line"><span class="string">    render_to_response()</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CreateView FBV</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">postCreate</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="comment"># form_factory : 폼을 쉽게 생성하기 위해 사용하는 클래스, Factory 패턴</span></span><br><span class="line">    <span class="comment"># 기존에 Form Class를 별도로 만드는 방식보다 간단하게 폼을 만들어서 처리할 수 있다는 장점이 있다.</span></span><br><span class="line">    form_class = modelform_factory(Post, fields=[<span class="string">'category'</span>, <span class="string">'title'</span>, <span class="string">'text'</span>])</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">"POST"</span>:</span><br><span class="line">        form = form_class(request.POST)</span><br><span class="line">        form.instance.author_id = request.user.id</span><br><span class="line">        <span class="keyword">if</span> form.is_valid():</span><br><span class="line">            instance = form.save()</span><br><span class="line">            <span class="keyword">return</span> redirect(instance)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        form = form_class()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'blog/post_create.html'</span>, &#123;<span class="string">'form'</span>: form&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># UpdateView CBV</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostUpdate</span><span class="params">(UpdateView)</span>:</span></span><br><span class="line">    model = Post</span><br><span class="line">    fields = [<span class="string">'category'</span>, <span class="string">'title'</span>, <span class="string">'text'</span>]</span><br><span class="line">    template_name = <span class="string">'blog/post_update.html'</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    setup()</span></span><br><span class="line"><span class="string">    dispatch()</span></span><br><span class="line"><span class="string">    get()</span></span><br><span class="line"><span class="string">    post() - 저장처리</span></span><br><span class="line"><span class="string">    get_object()</span></span><br><span class="line"><span class="string">    get_context_data()</span></span><br><span class="line"><span class="string">    render_to_response()</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># UpdateView FBV</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">postUpdate</span><span class="params">(request, pk)</span>:</span></span><br><span class="line">    object = get_object_or_404(Post, pk=pk)</span><br><span class="line">    form_class = modelform_factory(Post, fields=[<span class="string">'category'</span>, <span class="string">'title'</span>, <span class="string">'text'</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">"POST"</span>:</span><br><span class="line">        <span class="comment"># 수정시에는 instance 필히 지정</span></span><br><span class="line">        form = form_class(request.POST, instance=object)</span><br><span class="line">        <span class="keyword">if</span> form.is_valid():</span><br><span class="line">            instance = form.save()</span><br><span class="line">            <span class="keyword">return</span> redirect(instance)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 수정시에는 instance 필히 지정</span></span><br><span class="line">        form = form_class(instance=object)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'blog/post_update.html'</span>, &#123;<span class="string">'form'</span>: form&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># DeleteView CBV</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostDelete</span><span class="params">(DeleteView)</span>:</span></span><br><span class="line">    model = Post</span><br><span class="line">    template_name = <span class="string">'blog/post_delete.html'</span></span><br><span class="line">    success_url = reverse_lazy(<span class="string">'blog:post_list_cbv'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># DeleteView FBV</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">postDelete</span><span class="params">(request, pk)</span>:</span></span><br><span class="line">    post = get_object_or_404(Post, pk=pk)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">"POST"</span>:</span><br><span class="line">        post.delete()</span><br><span class="line">        <span class="keyword">return</span> redirect(reverse(<span class="string">'blog:post_list_cbv'</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">'blog/post_delete.html'</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>URL 만들기</p>
<ol>
<li><p>reverse</p>
<ul>
<li>가장 일반적으로 활용하는 메서드</li>
<li>URLConf에 있는 패턴 이름과 URL에 들어갈 매개변수 전달<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> reverse</span><br><span class="line"></span><br><span class="line">reverse(<span class="string">'blog:list'</span>)</span><br><span class="line">reverse(<span class="string">'blog:update'</span>, args=[<span class="number">1</span>])</span><br><span class="line">reverse(<span class="string">'blog:update'</span>, kwargs=&#123;<span class="string">'pk'</span>:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>reverse_lazy</p>
<ul>
<li>클래스형 뷰에서 success_url을 설정할 때<ul>
<li>reverse를 사용하면 URLConf가 로드되기 전에 동작하므로 오류 발생</li>
<li>이럴 경우, reverse_lazy를 사용<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.url <span class="keyword">import</span> reverse_lazy</span><br><span class="line"></span><br><span class="line">reverse_lazy(<span class="string">'blog:list'</span>)</span><br><span class="line">reverse_lazy(<span class="string">'blog:update'</span>, args=[<span class="number">1</span>])</span><br><span class="line">reverse_lazy(<span class="string">'blog:update'</span>, kwargs=&#123;<span class="string">'pk'</span>:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>resolve_url</p>
<ul>
<li>reverse의 간략화 버전<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> resolve_url</span><br><span class="line"></span><br><span class="line">resolve_url(<span class="string">'blog:list'</span>)</span><br><span class="line">resolve_url(<span class="string">'blog:update'</span>, <span class="number">1</span>)</span><br><span class="line">resolve_url(<span class="string">'blog:update'</span>, pk=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># object의 get_absolute_url을 호출하고 싶은 경우</span></span><br><span class="line">resolve_url(object)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>redirect</p>
<ul>
<li>URL을 생성하고 해당 URL로 이동하는 redirect response 메세지 생성<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> redirect</span><br><span class="line"></span><br><span class="line">redirect(<span class="string">'blog:list'</span>)</span><br><span class="line">redirect(<span class="string">'blog:update'</span>, <span class="number">1</span>)</span><br><span class="line">redirect(<span class="string">'blog:update'</span>, pk=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># object의 get_absolute_url을 호출하고 싶은 경우</span></span><br><span class="line">redirect(object)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>resolve</p>
<ul>
<li>주어진 URL로부터 URLConf 정보를 찾아냄<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> resolve</span><br><span class="line"></span><br><span class="line">url = resolve(request.path)</span><br><span class="line">url.route</span><br><span class="line">url.view_name</span><br><span class="line">url.url_name</span><br><span class="line">url.func</span><br><span class="line">url.kwargs</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://JINUKK.github.io/2019/05/30/190530-Django-Study/" data-id="cjyco4krg00af31wuz29xoq8n" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-190528-Django-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/28/190528-Django-Study/" class="article-date">
  <time datetime="2019-05-28T07:19:49.000Z" itemprop="datePublished">2019-05-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Study-Review/">Study Review</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/28/190528-Django-Study/">2019.05.28 Django Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="blog-Project"><a href="#blog-Project" class="headerlink" title="blog Project"></a>blog Project</h2><ul>
<li><p>github로 협업하여 진행</p>
</li>
<li><p>Social Login 이용하기(Facebook)</p>
<ul>
<li><p>Facebook login을 사용하기 위해서는 HTTPS URL을 사용해야 한다.</p>
</li>
<li><p>따라서 SSL을 적용해야 한다.</p>
</li>
<li><p>openssl로 인증서 만들기</p>
<ol>
<li><p>openssl의 버전을 확인한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ openssl version</span><br><span class="line"></span><br><span class="line"><span class="comment"># version이 나타나지 않는다면 설치해야 한다.</span></span><br><span class="line">$ sudo apt-get install openssl</span><br></pre></td></tr></table></figure>
</li>
<li><p>키 파일을 생성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ openssl genrsa 1024 &gt; stunnel.key</span><br></pre></td></tr></table></figure>
</li>
<li><p>cert 파일을 생성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -new -x509 -nodes -sha256 -days 365 -key django.key &gt;django.cert</span><br></pre></td></tr></table></figure>
</li>
<li><p>만든 해당 파일을 현재 진행중인 프로젝트 폴더로 복사해 넣는다.</p>
</li>
</ol>
</li>
<li><p>ssl runserver 사용하기</p>
<ol>
<li><p>django-sslserver를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install django-sslserver</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py의 INSTALLED_APPS에 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    <span class="string">'sslserver'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>다음 명령어를 실행해본다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 둘 중에 어떤 것으로 시작해도 된다.</span></span><br><span class="line">$ python manage.py runsslserver --certificate django.cert --key django.key</span><br><span class="line">$ python manage.py runsslserver</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>django allauth 사용하기(Facebook login)</p>
<ol>
<li><p>django-allauth를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install django-allauth</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py의 INSTALLED_APPS에 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    <span class="string">'django.contrib.sites'</span>,</span><br><span class="line">    <span class="string">'allauth'</span>,</span><br><span class="line">    <span class="string">'allauth.account'</span>,</span><br><span class="line">    <span class="string">'allauth.socialaccount'</span>,</span><br><span class="line">    <span class="string">'allauth.socialaccount.providers.facebook'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py에 다음 항목을 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AUTHENTICATION_BACKENDS = [</span><br><span class="line">    <span class="string">'django.contrib.auth.backends.ModelBackend'</span>,</span><br><span class="line">    <span class="string">'allauth.account.auth_backends.AuthenticationBackend'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">SITE_ID = <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>urls.py에 allauth 관련 urlpatterns를 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    path(<span class="string">'accounts/'</span>, include(<span class="string">'allauth.urls'</span>)),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>migrate를 한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py migrate</span><br></pre></td></tr></table></figure>
</li>
<li><p>Facebook 개발자 사이트로 이동한다.</p>
<ul>
<li><a href="https://developers.facebook.com/" target="_blank" rel="noopener">https://developers.facebook.com/</a></li>
</ul>
</li>
<li>로그인 한 후, 내 앱에서 새 앱 추가를 누른다.</li>
<li>적당한 앱 이름과 이메일을 입력하고 앱 ID 만들기를 누른다.</li>
<li>보안 확인 창이 나타나면 보안 확인을 완료하고 제출을 누른다.</li>
<li>앱 기능 중 Facebook 로그인 통합에 체크하고 확인을 누른다.</li>
<li>앱 생성이 완료되면 화면 하단의 내 제품 목록에서 Facebook 로그인의 설정을 누른다.</li>
<li><p>유효한 OAuth 리디렉션 URI에 다음과 같은 서버 주소를 입력한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://127.0.0.1:8000</span><br><span class="line"># &apos;accounts&apos;는 다른 이름으로 변경할 수 있다.</span><br><span class="line">https://127.0.0.1:8000/accounts/facebook/login/callback/</span><br></pre></td></tr></table></figure>
</li>
<li><p>앱 기본 설정 페이지로 이동하여 앱 ID와 시크릿 코드를 확인한다.</p>
</li>
<li><p>관리자 페이지로 접속하여 Social applications에 설정을 추가한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- Provider : Facebook</span><br><span class="line">- Name : Facebook login</span><br><span class="line">- Client id : [Facebook 개발자 사이트에 있는 앱 ID]</span><br><span class="line">- Secret key : [Facebook 개발자 사이트에 있는 시크릿 코드]</span><br><span class="line">- Sites에 있는 example.com 선택</span><br></pre></td></tr></table></figure>
</li>
<li><p>로그인 페이지에 접속하여 Facebook을 누른다.</p>
<ul>
<li>ex) <a href="https://127.0.0.1:8000/accounts/login/" target="_blank" rel="noopener">https://127.0.0.1:8000/accounts/login/</a></li>
</ul>
</li>
<li>Facebook 창이 나타나면 계속을 누른다.</li>
<li>관리자 페이지에서 소셜 계정이 등록되었는지 확인한다.</li>
</ol>
</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://JINUKK.github.io/2019/05/28/190528-Django-Study/" data-id="cjyco4krd00a931wujlcspuin" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-190527-Django-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/27/190527-Django-Study/" class="article-date">
  <time datetime="2019-05-27T07:10:44.000Z" itemprop="datePublished">2019-05-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Study-Review/">Study Review</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/27/190527-Django-Study/">2019.05.27 Django Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="editor-Project"><a href="#editor-Project" class="headerlink" title="editor Project"></a>editor Project</h2><ul>
<li><p>WYSIWYG 사용하기</p>
<ul>
<li>WYSIWYG(What you see is what you get)</li>
<li>웹 브라우저에서 사용할 수 있는 HTML 편집기</li>
</ul>
<ol>
<li><p>django-ckeditor 모듈을 다운받아 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install django-ckeditor</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py의 INSTALLED_APPS에 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    <span class="string">'ckeditor'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>models.py를 작성한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> ckeditor.fields <span class="keyword">import</span> RichTextField</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    content = RichTextField()</span><br></pre></td></tr></table></figure>
</li>
<li><p>migrate를 진행한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py makemigrations [앱 이름]</span><br><span class="line"></span><br><span class="line">$ python manage.py migrate [앱 이름]</span><br></pre></td></tr></table></figure>
</li>
<li><p>관리자 페이지에서 해당 필드가 에디터 형태로 나타나는지 확인한다.</p>
</li>
<li>template 파일을 통해 폼을 출력할 때는 필수로 form.media를 사용하도록 한다.<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    &#123;% csrf_token %&#125;</span><br><span class="line">    &#123;&#123;form.media&#125;&#125;</span><br><span class="line">    &#123;&#123;form.as_p&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Write"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>CKEditor 이미지 파일 업로더 설정하기</p>
<ol>
<li><p>django-ckeditor 모듈을 다운받아 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install django-ckeditor</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py의 INSTALLED_APPS에 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    <span class="string">'ckeditor'</span>,</span><br><span class="line">    <span class="string">'ckeditor_uploader'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py에 MEDIA_ROOT를 꼭 지정한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Amazon AWS S3를 사용할 경우, 지정할 필요가 없다.</span></span><br><span class="line">MEDIA_ROOT = os.path.join(BASE_DIR, <span class="string">'media'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># MEDIA_ROOT 하위 폴더에 전용 경로를 설정하고 싶다면</span></span><br><span class="line">CKEDITOR_UPLOAD_PATH = <span class="string">'upload/'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 에디터를 사용하는 유저별로 자신이 올린 파일드란 사용할 수 있게 하려면</span></span><br><span class="line">CKEDITOR_RESTRICT_BY_USER = <span class="literal">True</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>models.py를 작성한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> ckeditor_uploader.fields <span class="keyword">import</span> RichTextUploadingField</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    content = RichTextUploadingField()</span><br></pre></td></tr></table></figure>
</li>
<li><p>migrate를 진행한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py makemigrations [앱 이름]</span><br><span class="line"></span><br><span class="line">$ python manage.py migrate [앱 이름]</span><br></pre></td></tr></table></figure>
</li>
<li><p>urls.py에 업로더 내용을 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    path(<span class="string">'ckeditor/'</span>, include(<span class="string">'ckeditor_uploader.urls'</span>)),</span><br><span class="line">    <span class="comment"># Amazon AWS S3를 사용하지 않는 경우, media 파일 서빙하기</span></span><br><span class="line">    re_path(<span class="string">r'^media/(?P&lt;path&gt;.*)$'</span>, serve, &#123;<span class="string">'document_root'</span>:settings.MEDIA_ROOT&#125;),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>파일을 업로드하여 확인한다.</p>
</li>
</ol>
</li>
<li><p>Media 파일 서빙하기</p>
<ul>
<li>Amazon AWS S3를 사용할 수 없을 경우, serve view를 사용하여 서빙할 수 있다.</li>
</ul>
<ol>
<li><p>settings.py에 media 관련 경로를 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MEDIA_URL = <span class="string">'/media/'</span></span><br><span class="line">MEDIA_ROOT = os.path.join(BASE_DIR, <span class="string">'media'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>디버그 모드일 경우, 다음과 같이 url pattern을 추가하여 사용할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> settings.DEBUG:</span><br><span class="line">    <span class="keyword">from</span> django.conf.urls.static <span class="keyword">import</span> static</span><br><span class="line">    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)</span><br></pre></td></tr></table></figure>
</li>
<li><p>라이브 상태일 경우, serve view를 사용하여 연결해준다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.views.static <span class="keyword">import</span> serve</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> re_path</span><br><span class="line"></span><br><span class="line">url_patterns = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    re_path(<span class="string">r'^media/(?P&lt;path&gt;.*)$'</span>, serve, &#123;<span class="string">'document_root'</span>: settings.MEDIA_ROOT&#125;),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py에서 DEBUG를 False로 변경한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DEBUG = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">ALLOWED_HOSTS = [<span class="string">'*'</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>이미지를 업로드해보고 출력되는지 확인한다.</p>
</li>
</ol>
</li>
<li><p>Static 파일 서빙하기</p>
<ul>
<li>디버그 모드일 때만 <figure class="highlight plain"><figcaption><span>load static %&#125;```을 이용하여 static 태그를 이용해 리소스를 사용할 수 있다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- Amazon AWS S3를 사용할 수 없을 경우, serve view를 사용하여 서빙할 수 있다.</span><br><span class="line">1. whitenoise를 설치한다.</span><br><span class="line">```bash</span><br><span class="line"># whitenoise는 static 파일들을 collectstatic 명령 수행시 지정 경로에 파일을 모아준다.</span><br><span class="line">$ pip install whitenoise</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="2">
<li><p>settings.py의 MIDDLEWARE에 추가하고 static 경로를 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MIDDLEWARE = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    <span class="string">'whitenoise.middleware.WhiteNoiseMiddleware'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">STATIC_URL = <span class="string">'/static/'</span></span><br><span class="line">STATIC_ROOT = os.path.join(BASE_DIR, <span class="string">'static'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py에서 DEBUG를 False로 변경한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DEBUG = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">ALLOWED_HOSTS = [<span class="string">'*'</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>collectstatic 명령어를 실행한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 아래 명령어를 실행하지 않고 관리자 페이지를 접속할 경우, 폼이 깨져서 나온다.</span></span><br><span class="line"><span class="comment"># whitenoise는 STATIC_URL이 포함된 리소스를 STATIC_ROOT를 통해 찾아 전달한다.</span></span><br><span class="line">$ python manage.py collectstatic</span><br></pre></td></tr></table></figure>
</li>
<li><p>관리자 페이지로 접속하여 확인한다.</p>
</li>
</ol>
</li>
<li><p>Nginx를 사용한 리소스 파일 서빙하기</p>
<ul>
<li>Nginx 설정 파일에 다음과 같은 내용을 추가한다.</li>
<li><p>ex) vim /etc/nginx/sites-available/default</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 최대 업로드 용량</span></span><br><span class="line">client_max_body_size 75M</span><br><span class="line"></span><br><span class="line">location /media &#123;</span><br><span class="line">    <span class="built_in">alias</span> /var/www/django/media;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location /static &#123;</span><br><span class="line">    <span class="built_in">alias</span> /var/www/django/static;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>서버 설정 적용을 위해 Nginx를 재시작한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl restart nginx</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>FTP로 파일 업로드 하기</p>
<ul>
<li>FTP 프로그램을 이용하여 서버에 직접 소스 코드를 업로드하는 방식을 알아보자.</li>
<li>Filezilla를 이용한다.</li>
</ul>
<ol>
<li><p>filezilla를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install filezilla</span><br></pre></td></tr></table></figure>
</li>
<li><p>filezilla를 실행하여 왼쪽 상단 탭에서 사이트 관리자로 들어간다.</p>
</li>
<li><p>새로운 사이트를 추가하고 접속 정보를 설정한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- 프로토콜 : SFTP</span><br><span class="line">- 호스트 : EC2의 접속 주소</span><br><span class="line">- 로그온 유형 : 키 파일</span><br><span class="line">- 사용자 : ubuntu</span><br><span class="line">- 키 파일 : 키 페어 파일 경로 지정</span><br></pre></td></tr></table></figure>
</li>
<li><p>고급 탭에서 기본 로컬 디렉터리와 기본 리모트 디렉터리를 지정한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">기본 로컬 디렉터리 = pycharm으로 만든 프로젝트 폴더</span><br><span class="line">기본 리모트 디렉터리 = 소스 코드를 업로드할 폴더</span><br></pre></td></tr></table></figure>
</li>
<li><p>설정이 완료되었다면 연결을 누른다.</p>
</li>
<li>처음 접속 시, 알 수 없는 호스트 창이 나타나면 캐시에 등록을 체크하고 확인을 누른다.</li>
<li>접속이 성공했다면, 소스 코드를 업로드한다.</li>
</ol>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://JINUKK.github.io/2019/05/27/190527-Django-Study/" data-id="cjyco4krc00a731wu7hduumxx" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-190523-Django-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/23/190523-Django-Study/" class="article-date">
  <time datetime="2019-05-23T03:56:59.000Z" itemprop="datePublished">2019-05-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Study-Review/">Study Review</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/23/190523-Django-Study/">2019.05.23 Django Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Django-Project"><a href="#Django-Project" class="headerlink" title="Django Project"></a>Django Project</h2><ul>
<li><p>EC2에 장고 서버 셋팅하기</p>
<ol>
<li><p>EC2에 SSH로 접속한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 퍼블릭 DNS 주소를 가지고 있다면</span></span><br><span class="line">$ ssh -i ~/.ssh/[키페어 파일 이름] ubuntu@[EC2의 퍼블릭 DNS]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 탄력적 IP를 가지고 있다면</span></span><br><span class="line">$ ssh -i ~/.ssh/[키페어 파일 이름] ubuntu@[할당받은 탄력적 IP]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Route53을 통해 도메인을 연결했다면</span></span><br><span class="line">$ ssh -i ~/.ssh/[키페어 파일 이름] ubuntu@[연결한 도메인 주소]</span><br></pre></td></tr></table></figure>
</li>
<li><p>장고를 위한 계정을 추가한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /var/www</span><br><span class="line"></span><br><span class="line"><span class="comment"># -g : 현재 그룹에 바로 추가</span></span><br><span class="line"><span class="comment"># -b : 홈 폴더 지정</span></span><br><span class="line"><span class="comment"># -m : 유저의 홈 폴더 생성</span></span><br><span class="line"><span class="comment"># -s : 기본으로 사용할 쉘 지정</span></span><br><span class="line">$ sudo useradd -g www-data -b /home -m -s /bin/bash django</span><br></pre></td></tr></table></figure>
</li>
<li><p>소스 코드를 업로드할 폴더를 만든다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mkdir /var/www/django</span><br></pre></td></tr></table></figure>
</li>
<li><p>소스 코드 폴더의 소유자를 변경한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo chown django:www-data /var/www/django</span><br></pre></td></tr></table></figure>
</li>
<li><p>파일 업로드를 위해 ubuntu 계정을 www-data 그룹에 추가한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -a : 추가 명령</span></span><br><span class="line"><span class="comment"># -G : 그룹 추가 명령</span></span><br><span class="line">$ sudo usermod -a -G www-data ubuntu</span><br></pre></td></tr></table></figure>
</li>
<li><p>파이썬 관련 패키지를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install python3-dev python3-venv python3-pip</span><br></pre></td></tr></table></figure>
</li>
<li><p>소스 코드 폴더 밑에 파이썬 가상 환경을 만든다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo python3 -m venv /var/www/django/venv</span><br></pre></td></tr></table></figure>
</li>
<li><p>관리자 모드로 변경한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -s</span><br><span class="line"><span class="comment"># ubuntu에서 root로 바뀌는지 확인한다.</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>가상 환경을 활성화한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> venv/bin/activate</span><br></pre></td></tr></table></figure>
</li>
<li><p>가상 환경에 장고를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install django</span><br></pre></td></tr></table></figure>
</li>
<li><p>장고 프로젝트를 생성하고 migrate한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ django-admin startproject config .</span><br><span class="line"></span><br><span class="line">$ python manage.py migrate</span><br><span class="line"></span><br><span class="line"><span class="comment"># 장고에서 서버를 실행해서 동작을 확인한다.</span></span><br><span class="line"><span class="comment"># 인스턴스 보안에서 테스트를 위해 인바운드 규칙에 포트 번호 8000을 추가한 것을 이용</span></span><br><span class="line"><span class="comment"># 0:8000에서 0은 외부 트래픽에서도 받아보겠다는 의미</span></span><br><span class="line">$ python manage.py runserver 0:8000</span><br><span class="line"></span><br><span class="line"><span class="comment"># 반드시 장고에서 서버 동작을 확인하도록 하자.</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>uwsgi 모듈을 설치한다.(WSGI 모듈 중 하나)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install uwsgi</span><br></pre></td></tr></table></figure>
</li>
<li><p>uwsgi가 동작하는지 아래 명령어를 입력한 후, 웹 브라우저로 접속해본다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ uwsgi --http :8000 --home /var/www/django/venv/ --<span class="built_in">chdir</span> /var/www/django/ --module config.wsgi</span><br><span class="line"><span class="comment"># 웹 브라우저에 [ssh 접속 시 사용한 주소]:8000으로 접속해본다.</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>관련 폴더를 만들고 설정해본다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># run과 logs 폴더를 만든다.</span></span><br><span class="line">$ sudo mkdir run logs</span><br><span class="line"></span><br><span class="line"><span class="comment"># 폴더의 소유권을 변경한다.</span></span><br><span class="line">$ sudo chown django:www-data run</span><br><span class="line">$ sudo chown django:www-data logs</span><br><span class="line"></span><br><span class="line"><span class="comment"># ini 폴더를 만든다.</span></span><br><span class="line">$ sudo mkdir ini</span><br><span class="line"></span><br><span class="line"><span class="comment"># ini 폴더 안에 uwsgi.ini 파일을 작성한다.</span></span><br><span class="line">$ sudo vim ini/uwsgi.ini</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># uwsgi.ini 내용</span></span><br><span class="line">[uwsgi]</span><br><span class="line">uid = django</span><br><span class="line">base = /var/www/django</span><br><span class="line"></span><br><span class="line">home = %(base)/venv</span><br><span class="line"><span class="built_in">chdir</span> = %(base)</span><br><span class="line">module = config.wsgi:application</span><br><span class="line">env = DJANGO_SETTINGS_MODULE=config.settings</span><br><span class="line"></span><br><span class="line">master = <span class="literal">true</span></span><br><span class="line">processes = 5</span><br><span class="line"></span><br><span class="line">socket = %(base)/run/uwsgi.sock</span><br><span class="line">logto = %(base)/logs/uwsgi.log</span><br><span class="line">chown-socket = %(uid):www-data</span><br><span class="line">chmod-socket = 660</span><br><span class="line">vacuum = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># uwsgi.service 파일을 만든다.</span></span><br><span class="line">$ sudo vim /etc/systemed/system/uwsgi.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># uwsgi.service 내용</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=uWSGI Emperor service</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStart=/var/www/django/venv/bin/uwsgi --emperor /var/www/django/ini</span><br><span class="line">User=django</span><br><span class="line">Group=www-data</span><br><span class="line">Restart=on-failure</span><br><span class="line">KillSignal=SIGQUIT</span><br><span class="line">Type=notify</span><br><span class="line">NotifyAccess=all</span><br><span class="line">StandardError=syslog</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># uwsgi.service를 시작하고 시작 프로그램으로 등록한다.</span></span><br><span class="line">$ sudo systemctl start uwsgi</span><br><span class="line">$ sudo systemctl <span class="built_in">enable</span> uwsgi</span><br></pre></td></tr></table></figure>
</li>
<li><p>사이트 설정 파일을 변경하여 장고 애플리케이션이 구동되도록 한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 기존에 만들어두었던 staticweb 파일을 사용한다.</span></span><br><span class="line">$ sudo vim /etc/nginx/sites-available/staticweb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># staticweb 내용</span></span><br><span class="line">upstream django &#123;</span><br><span class="line">        server unix:/var/www/django/run/uwsgi.sock;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        charset utf-8;</span><br><span class="line">        access_log /var/www/django/logs/access.log;</span><br><span class="line">        error_log /var/www/django/logs/error.log;</span><br><span class="line">        server_name [Route53으로 연결한 도메인 주소]</span><br><span class="line"></span><br><span class="line">        location = /favicon.ico &#123; access_log off; log_not_found off; &#125;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                include         /etc/nginx/uwsgi_params;</span><br><span class="line">                uwsgi_pass      django;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>웹 브라우저에 도메인 주소를 입력하고 구동되는지 확인한다.</p>
</li>
</ol>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://JINUKK.github.io/2019/05/23/190523-Django-Study/" data-id="cjyco4kra00a531wuhmjibyqk" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-190522-Django-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/22/190522-Django-Study/" class="article-date">
  <time datetime="2019-05-22T14:40:10.000Z" itemprop="datePublished">2019-05-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Study-Review/">Study Review</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/22/190522-Django-Study/">2019.05.22 Django Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Django-Project"><a href="#Django-Project" class="headerlink" title="Django Project"></a>Django Project</h2><ul>
<li><p>EC2에 웹 서버 설정하기</p>
<ol>
<li><p>EC2에 SSH로 접속한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -i ~/.ssh/[키페어 파일 이름] ubuntu@[EC2의 퍼블릭 DNS]</span><br></pre></td></tr></table></figure>
</li>
<li><p>접속이 성공했다면 패키지를 최신으로 업데이트한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br></pre></td></tr></table></figure>
</li>
<li><p>Nginx를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># apt-get 사용</span></span><br><span class="line">$ sudo apt-get install nginx</span><br></pre></td></tr></table></figure>
</li>
<li><p>nginx가 잘 동작하는지 다음 명령어를 통해 확인한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl status nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># nginx를 설치했다면...</span></span><br><span class="line"><span class="comment"># status 명령어를 통해 상태를 확인한다.(active)</span></span><br><span class="line"><span class="comment"># 웹 브라우저에서 퍼블릭 DNS 주소를 입력하여 확인한다.(Welcome to nginx 화면)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 아래 명령어를 알아두자.</span></span><br><span class="line">$ sudo systemctl stop nginx</span><br><span class="line">$ sudo systemctl start nginx</span><br><span class="line">$ sudo systemctl restart nginx</span><br><span class="line">$ systemctl status nginx</span><br></pre></td></tr></table></figure>
</li>
<li><p>Nginx는 한 서버 컴ㅍ퓨터에서 여러 사이트를 운영할 수 있다.</p>
<ul>
<li>사이트 별로 설정 파일을 만들어야 한다.</li>
<li>여기서는 staticweb이라는 이름을 예시로 사용해본다.<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># default 파일을 복사하여 staticweb 파일 생성</span></span><br><span class="line"><span class="comment"># 파일 이름은 자유롭게 생성하자.</span></span><br><span class="line">$ sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/staticweb</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>생성한 설정 파일을 수정한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/nginx/sites-available/staticweb</span><br><span class="line"></span><br><span class="line"><span class="comment"># staticweb</span></span><br><span class="line"><span class="comment"># default 파일을 복사했기 때문에 아래와 같이 내용을 수정한다.</span></span><br><span class="line"><span class="comment"># server_name에는 퍼블릭 DNS 주소를 기입한다.</span></span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    listen [::]:80;</span><br><span class="line"></span><br><span class="line">    root /var/www/staticweb;</span><br><span class="line"></span><br><span class="line">    index index.html index.htm index.nginx-debian.html;</span><br><span class="line"></span><br><span class="line">    server_name [퍼블릭 DNS]</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">            try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ =404;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>설정 파일을 Nginx에 활성화시킨다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 심볼릭 링크를 사용하여 sites-enabled에 링크 파일을 생성한다.</span></span><br><span class="line"><span class="comment"># site-enabled에 파일이 위치해야 사이트가 동작한다.</span></span><br><span class="line">$ sudo ln -s /etc/nginx/sites-available/staticweb /etc/nginx/sites-enabled</span><br></pre></td></tr></table></figure>
</li>
<li><p>테스트를 위해 staticweb이라는 폴더를 만든다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /var/www/</span><br><span class="line">$ sudo mkdir staticweb</span><br></pre></td></tr></table></figure>
</li>
<li><p>staticweb 폴더 안에 index.html을 생성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /var/www/staticweb</span><br><span class="line">$ vim index.html</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        hello</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>웹 브라우저에서 퍼블릭 DHS 주소를 입력하여 hello가 출력되는지 확인한다.</p>
</li>
</ol>
</li>
<li><p>EC2 인스턴스에 고정 IP 설정하기</p>
<ul>
<li>퍼블릭 DNS의 IP는 동적으로 변하는 상태이기 때문에 연결이 끊기는 상황이 발생할 수 있다.</li>
<li>Elastic IP 서비스를 사용하여 고정 IP를 할당받을 수 있다.</li>
</ul>
<ol>
<li>EC2 화면 좌측 메뉴에서 네트워크 및 보안 / 탄력적 IP를 선택한다.</li>
<li>새 주소 할당을 누른다.<ul>
<li>IP의 사용은 무료이지만, IP를 할당받고 사용하지 않으면 비용이 청구된다.</li>
<li>따라서 사용하지 않는다면 삭제하자.</li>
</ul>
</li>
<li>할당을 누르고 새 주소 요청 성공이 보이면 닫기를 누른다.</li>
<li>IP 목록에서 할당받은 IP를 마우스 오른쪽 버튼으로 클릭한다.</li>
<li>주소 연결을 누르고 인스턴스 항목에 사용할 인스턴스를 선택하고 연결을 누른다.</li>
<li>주소 연결 요청 성공이 보이면 닫기를 누른다.</li>
<li>인스턴스 목록으로 가서 사용할 인스턴스에 설정이 되었는지 확인한다.<ul>
<li>퍼블릭 DNS 주소 대신에 탄력적 IP가 나타나는지 확인한다.</li>
</ul>
</li>
<li>[서비스] 메뉴에서 네트워킹 및 콘텐츠 전송/Route53으로 이동한다.</li>
<li>호스팅 영역으로 이동하여 사용중인 도메인을 누른다.</li>
<li>레코드 세트 생성을 누른다.<ul>
<li>원하는 이름을 설정한다.</li>
<li>유형은 A-IPv4 주소를 선택한다.</li>
<li>값에 할당받은 탄력적 IP를 기입하고 생성한다.</li>
</ul>
</li>
<li>이제 ssh로 접속할 때 설정한 도메인 이름으로 접속할 수 있다.</li>
<li>staticweb 설정 파일에서 server_name을 설정한 도메인 주소로 바꾸자.<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/nginx/sites-available/staticweb</span><br><span class="line"></span><br><span class="line"> <span class="comment"># staticweb</span></span><br><span class="line"><span class="comment"># server_name에 연결한 도메인 주소를 기입한다.</span></span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    listen [::]:80;</span><br><span class="line"></span><br><span class="line">    root /var/www/staticweb;</span><br><span class="line"></span><br><span class="line">    index index.html index.htm index.nginx-debian.html;</span><br><span class="line"></span><br><span class="line">    server_name [Route53을 통해 연결한 도메인 주소]</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">            try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ =404;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>커스텀 유저 모델 만들기</p>
<ul>
<li><p>생성한 장고 프로젝트에서 account 앱을 생성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py starapp account</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py의 INSTALLED_APPS에 앱을 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> INSTALLED_APPS = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    <span class="string">'account'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>models.py를 작성한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># 기존에 있던 User 모델을 확장해서</span></span><br><span class="line"><span class="comment"># 내가 원하는 추가 필드를 만드는 것</span></span><br><span class="line"><span class="comment"># 커뮤니티 사이트 - 프로필 사진, 자기소개</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">기존에 모델을 확장(필드를 추가)하려면 모델 소스코드를 변경하는데,</span></span><br><span class="line"><span class="string">애시당초 모델을 만들 때는 models.Model을 상속받는다.</span></span><br><span class="line"><span class="string">* 모델은 어떤 모델을 상속받아서 확장할 수도 있다.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">기존 User 모델은 AbstractUser라는 모델을 상속받아서 구현된다.</span></span><br><span class="line"><span class="string">AbstractUser모델은 AbstractBaseUser라는 모델을 상속받아서 구현된다.</span></span><br><span class="line"><span class="string">* Abstract : 추상이라고 해석되는 단어인데, 모델의 설정값에 Abstract라는 값을 설정할 수 있다.</span></span><br><span class="line"><span class="string">abstract가 설정되어 있으면 실제 모델로 사용 불가</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1) 기존 User 모델은 AbstractUser라는 모델을 상속받아서 필수 필드들이 이미 구현이 되어있는 상태다.</span></span><br><span class="line"><span class="string">- 우리가 익히 보던 기본 필드들과 권한 관련 기능 등 장고에서 유저에게 기본적으로 필요한 기능이 구현이 되어있다.</span></span><br><span class="line"><span class="string">- 추가 필드가 필요한 경우에는 AbstractUser 모델을 상속받아서 구현하는 것이 제일 편하다.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2) AbstractBaseUser로 구현해야 되는 경우</span></span><br><span class="line"><span class="string">- 모든 필드 구조를 변경할 필요가 있을 때</span></span><br><span class="line"><span class="string">- 퍼미션 기능 등 장고에서 사용하는 유저 기본 기능 전체를 뜯어 고치고 싶을 때</span></span><br><span class="line"><span class="string">- Backend를 새로 구현해줘야 한다.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3) 기존 User 모델을 상속받거나, 확장해서 사용하는 경우</span></span><br><span class="line"><span class="string">- User + AdditionalInfo(생일, 주소, 주민번호)</span></span><br><span class="line"><span class="string">-&gt; 회원 수정 페이지 AdditionalInfoForm을 추가로 입력</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1번을 제일 권장하는 확장 방식 - 프로젝트 시작 시점에 고려, (* 기존 데이터 유지 불가)</span></span><br><span class="line"><span class="string">3번은  사이트를 운영 중에 확장을 고려해야 할 때 선택 가능, 기존 User 데이터 그대로 존재, + 추가 테이블</span></span><br><span class="line"><span class="string">* OneToOne 필드</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">swappable은 AUTH_USER_MODEL 값에 설정된 모델과 교체가 가능하다라고 미리 설정해둔 것</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class User(AbstractUser):</span></span><br><span class="line"><span class="string">    class Meta(AbstractUser.Meta):</span></span><br><span class="line"><span class="string">        swappable = 'AUTH_USER_MODEL'</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> AbstractUser</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(AbstractUser)</span>:</span></span><br><span class="line">    message = models.TextField(blank=<span class="literal">True</span>)</span><br><span class="line">    profile = models.ImageField(upload_to=<span class="string">'user_images/profile/%Y/%m/%d'</span>, blank=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py에 아래 항목을 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AUTH_USER_MODEL = <span class="string">'account.User'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>새로 만든 유저 모델의 데이터베이스 생성을 위해 아래 명령어를 실행한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 모델에 이미지 필드가 있으므로 pillow 모듈 설치</span></span><br><span class="line">$ pip install pillow</span><br><span class="line"></span><br><span class="line">$ python manage.py makemigrations account</span><br><span class="line"></span><br><span class="line">$ python manage.py migrate</span><br></pre></td></tr></table></figure>
</li>
<li><p>관리자 계정을 생성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py createsuperuser</span><br></pre></td></tr></table></figure>
</li>
<li><p>admin.py에 유저 모델을 등록해준다. 등록하지 않으면 관리자 페이지에서 볼 수 없다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"></span><br><span class="line">admin.site.register(User)</span><br></pre></td></tr></table></figure>
</li>
<li><p>관리자 페이지에 접속하여 유저 모델을 수정해보면 기존 유저 모델 화면과 다른 것을 확인할 수 있다.</p>
<ul>
<li>UserAdmin 클래스 옵션을 등록하여 기존 유저 모델과 같이 보이게 할 수 있다.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.admin <span class="keyword">import</span> UserAdmin</span><br><span class="line"></span><br><span class="line">admin.site.register(User, CustomUserAdmin)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>모델에서 만든 추가 필드 값에 대한 클래스를 새로 만들어서 등록해줘야 한다.</p>
<ul>
<li>message와 profile의 필드 값이 나타나지 않는 것을 확인할 수 있다.</li>
<li>admin.py를 다음과 같이 수정한다.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.admin <span class="keyword">import</span> UserAdmin</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomUserAdmin</span><span class="params">(UserAdmin)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># fieldsets - 상세 화면에서 출력될 수정 폼 설정</span></span><br><span class="line">    <span class="comment"># add_fieldsets - 추가 화면에 출력될 입력 폼의 설정</span></span><br><span class="line">    UserAdmin.fieldsets[<span class="number">1</span>][<span class="number">1</span>][<span class="string">'fields'</span>]+=(<span class="string">'profile'</span>,<span class="string">'message'</span>)</span><br><span class="line"></span><br><span class="line">    UserAdmin.add_fieldsets += (</span><br><span class="line">        ((<span class="string">'Additional Info'</span>), &#123;<span class="string">'fields'</span>:(<span class="string">'profile'</span>,<span class="string">'message'</span>)&#125;),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="comment"># CustomUserAdmin으로 옵션 클래스 수정</span></span><br><span class="line">admin.site.register(User, CustomUserAdmin)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>관리자 페이지로 접속하여 추가 필드 값이 출력되는지 확인한다.</p>
<ul>
<li>추가 필드에 값이 정상적으로 입력되는지 확인하자.</li>
</ul>
</li>
</ul>
</li>
<li><p>Email 로그인 기능 추가하기</p>
<ul>
<li>로그인 기능을 제어하는 것은 AUTHENTICATION_BACKENDS에 설정된 모델 백엔드를 통해 이뤄진다.</li>
<li>커스텀 모델 백엔드를 추가하여 username과 email 모두 가능한 로그인 기능을 만든다.</li>
</ul>
<ol>
<li><p>account 앱에 backends.py를 추가하고 다음과 같이 입력한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth <span class="keyword">import</span> get_user_model</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomUserBackend</span><span class="params">(ModelBackend)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate</span><span class="params">(self, request, username=None, password=None, **kwargs)</span>:</span></span><br><span class="line">        user = super().authenticate(request, username, password, **kwargs)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> user:</span><br><span class="line">            <span class="keyword">return</span> user</span><br><span class="line"></span><br><span class="line">        <span class="comment"># id 로그인 실패 상황</span></span><br><span class="line">        <span class="comment"># email 로그인 시도</span></span><br><span class="line">        UserModel = get_user_model()</span><br><span class="line">        <span class="comment"># 원래 id 로그인 처리를 할 때 username이 넘어왔을 경우</span></span><br><span class="line">        <span class="comment"># email 변수에 새로 값을 할당하려고</span></span><br><span class="line">        email = username</span><br><span class="line">        <span class="keyword">if</span> email <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            email = kwargs.get(UserModel.EMAIL_FIELD, kwargs.get(<span class="string">'email'</span>))</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            user = UserModel._default_manager.get(email=email)</span><br><span class="line">        <span class="keyword">except</span> UserModel.DoesNotExist:</span><br><span class="line">            <span class="comment"># Run the default password hasher once to reduce the timing</span></span><br><span class="line">            <span class="comment"># difference between an existing and a nonexistent user (#20760).</span></span><br><span class="line">            UserModel().set_password(password)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> user.check_password(password) <span class="keyword">and</span> self.user_can_authenticate(user):</span><br><span class="line">                <span class="keyword">return</span> user</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py에 아래 항목을 추가한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AUTHENTICATION_BACKENDS = [</span><br><span class="line">    <span class="string">'account.backends.CustomUserBackend'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>관리자 페이지를 접속하여 이메일로 접속되는지 확인한다.</p>
</li>
</ol>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://JINUKK.github.io/2019/05/22/190522-Django-Study/" data-id="cjyco4kre00ab31wujzuwd7rb" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/Sort/">Sort</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Study-Review/">Study Review</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/args/">args</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/binary-search/">binary search</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/boolean/">boolean</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bubble-sort/">bubble sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/caculator/">caculator</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/call-by-object-reference/">call by object reference</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/class/">class</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/closure/">closure</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/comparison/">comparison</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/comprehension/">comprehension</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/continue/">continue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/copy/">copy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csv/">csv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/decorator/">decorator</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dictionary/">dictionary</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dummy-double-linked-list/">dummy double linked list</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/epsilon/">epsilon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/excel/">excel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/filter/">filter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/first-class-function/">first class function</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/for/">for</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/function/">function</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/generator/">generator</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/if/">if</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/insertion-sort/">insertion sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iterator/">iterator</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kwargs/">kwargs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lambda-function/">lambda function</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linear-search/">linear search</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linked-list/">linked list</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/list/">list</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/map/">map</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/merge-sort/">merge sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/namespace/">namespace</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/next/">next</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/operator/">operator</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/packing/">packing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pass/">pass</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/queue/">queue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quick-sort/">quick sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/radix/">radix</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/recursive-function/">recursive function</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reduce/">reduce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/selection-sort/">selection sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/set/">set</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/single-linked-list/">single linked list</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sort/">sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stack/">stack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stopiteration/">stopiteration</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/string/">string</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/text/">text</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tower-of-hanoi/">tower of hanoi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tuple/">tuple</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unpacking/">unpacking</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/while/">while</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wrap/">wrap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yield/">yield</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yield-from/">yield from</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/algorithm/" style="font-size: 16.67px;">algorithm</a> <a href="/tags/args/" style="font-size: 10px;">args</a> <a href="/tags/binary-search/" style="font-size: 10px;">binary search</a> <a href="/tags/boolean/" style="font-size: 10px;">boolean</a> <a href="/tags/bubble-sort/" style="font-size: 10px;">bubble sort</a> <a href="/tags/caculator/" style="font-size: 10px;">caculator</a> <a href="/tags/call-by-object-reference/" style="font-size: 10px;">call by object reference</a> <a href="/tags/class/" style="font-size: 10px;">class</a> <a href="/tags/closure/" style="font-size: 10px;">closure</a> <a href="/tags/comparison/" style="font-size: 10px;">comparison</a> <a href="/tags/comprehension/" style="font-size: 10px;">comprehension</a> <a href="/tags/continue/" style="font-size: 10px;">continue</a> <a href="/tags/copy/" style="font-size: 10px;">copy</a> <a href="/tags/csv/" style="font-size: 10px;">csv</a> <a href="/tags/decorator/" style="font-size: 10px;">decorator</a> <a href="/tags/dictionary/" style="font-size: 10px;">dictionary</a> <a href="/tags/dummy-double-linked-list/" style="font-size: 10px;">dummy double linked list</a> <a href="/tags/epsilon/" style="font-size: 10px;">epsilon</a> <a href="/tags/excel/" style="font-size: 10px;">excel</a> <a href="/tags/filter/" style="font-size: 10px;">filter</a> <a href="/tags/first-class-function/" style="font-size: 10px;">first class function</a> <a href="/tags/for/" style="font-size: 10px;">for</a> <a href="/tags/function/" style="font-size: 10px;">function</a> <a href="/tags/generator/" style="font-size: 10px;">generator</a> <a href="/tags/if/" style="font-size: 10px;">if</a> <a href="/tags/insertion-sort/" style="font-size: 10px;">insertion sort</a> <a href="/tags/iterator/" style="font-size: 10px;">iterator</a> <a href="/tags/kwargs/" style="font-size: 10px;">kwargs</a> <a href="/tags/lambda-function/" style="font-size: 10px;">lambda function</a> <a href="/tags/linear-search/" style="font-size: 10px;">linear search</a> <a href="/tags/linked-list/" style="font-size: 13.33px;">linked list</a> <a href="/tags/list/" style="font-size: 10px;">list</a> <a href="/tags/map/" style="font-size: 10px;">map</a> <a href="/tags/merge-sort/" style="font-size: 10px;">merge sort</a> <a href="/tags/namespace/" style="font-size: 10px;">namespace</a> <a href="/tags/next/" style="font-size: 10px;">next</a> <a href="/tags/operator/" style="font-size: 13.33px;">operator</a> <a href="/tags/packing/" style="font-size: 10px;">packing</a> <a href="/tags/pass/" style="font-size: 10px;">pass</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/queue/" style="font-size: 13.33px;">queue</a> <a href="/tags/quick-sort/" style="font-size: 10px;">quick sort</a> <a href="/tags/radix/" style="font-size: 10px;">radix</a> <a href="/tags/recursive-function/" style="font-size: 10px;">recursive function</a> <a href="/tags/reduce/" style="font-size: 10px;">reduce</a> <a href="/tags/selection-sort/" style="font-size: 10px;">selection sort</a> <a href="/tags/set/" style="font-size: 10px;">set</a> <a href="/tags/single-linked-list/" style="font-size: 10px;">single linked list</a> <a href="/tags/sort/" style="font-size: 10px;">sort</a> <a href="/tags/stack/" style="font-size: 10px;">stack</a> <a href="/tags/stopiteration/" style="font-size: 13.33px;">stopiteration</a> <a href="/tags/string/" style="font-size: 10px;">string</a> <a href="/tags/text/" style="font-size: 10px;">text</a> <a href="/tags/tower-of-hanoi/" style="font-size: 10px;">tower of hanoi</a> <a href="/tags/tuple/" style="font-size: 10px;">tuple</a> <a href="/tags/unpacking/" style="font-size: 10px;">unpacking</a> <a href="/tags/while/" style="font-size: 10px;">while</a> <a href="/tags/wrap/" style="font-size: 10px;">wrap</a> <a href="/tags/yield/" style="font-size: 10px;">yield</a> <a href="/tags/yield-from/" style="font-size: 10px;">yield from</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/07/18/190718-DSAA-Study/">2019.07.18 Data Structure and Algorithm Study</a>
          </li>
        
          <li>
            <a href="/2019/07/15/190715-DSAA-Study/">2019.07.15 Data Structure and Algorithm Study</a>
          </li>
        
          <li>
            <a href="/2019/07/11/190711-DSAA-Study/">2019.07.11 Data Structure and Algorithm Study</a>
          </li>
        
          <li>
            <a href="/2019/07/08/190708-DSAA-Study/">2019.07.08 Data Structure and Algorithm Study</a>
          </li>
        
          <li>
            <a href="/2019/07/04/190704-DSAA-Study/">2019.07.04 Data Structure and Algorithm Study</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 JINWOOK KOO<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>